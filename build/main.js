function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function s(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function f(){return u(" ")}function d(){return u("")}function p(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function h(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function g(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}let b;function y(e){b=e}function $(){if(!b)throw new Error("Function called outside component initialization");return b}const w=[],v=[],x=[],_=[],k=Promise.resolve();let A=!1;function C(e){x.push(e)}let I=!1;const j=new Set;function E(){if(!I){I=!0;do{for(let e=0;e<w.length;e+=1){const t=w[e];y(t),P(t.$$)}for(y(null),w.length=0;v.length;)v.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];j.has(t)||(j.add(t),t())}x.length=0}while(w.length);for(;_.length;)_.pop()();A=!1,I=!1,j.clear()}}function P(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(C)}}const T=new Set;let U,L;function S(){U={r:0,c:[],p:U}}function z(){U.r||o(U.c),U=U.p}function O(e,t){e&&e.i&&(T.delete(e),e.i(t))}function N(e,t,n,o){if(e&&e.o){if(T.has(e))return;T.add(e),U.c.push((()=>{T.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}}function R(e,t){const n=t.token={};function o(e,o,r,l){if(t.token!==n)return;t.resolved=l;let i=t.ctx;void 0!==r&&(i=i.slice(),i[r]=l);const c=e&&(t.current=e)(i);let a=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==o&&e&&(S(),N(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),z())})):t.block.d(1),c.c(),O(c,1),c.m(t.mount(),t.anchor),a=!0),t.block=c,t.blocks&&(t.blocks[o]=c),a&&E()}if((r=e)&&"object"==typeof r&&"function"==typeof r.then){const n=$();if(e.then((e=>{y(n),o(t.then,1,t.value,e),y(null)}),(e=>{if(y(n),o(t.catch,2,t.error,e),y(null),!t.hasCatch)throw e})),t.current!==t.pending)return o(t.pending,0),!0}else{if(t.current!==t.then)return o(t.then,1,t.value,e),!0;t.resolved=e}var r}function H(e,t,n){const o=t.slice(),{resolved:r}=e;e.current===e.then&&(o[e.value]=r),e.current===e.catch&&(o[e.error]=r),e.block.p(o,n)}function q(e){e&&e.c()}function M(e,n,l,i){const{fragment:c,on_mount:a,on_destroy:s,after_update:u}=e.$$;c&&c.m(n,l),i||C((()=>{const n=a.map(t).filter(r);s?s.push(...n):o(n),e.$$.on_mount=[]})),u.forEach(C)}function W(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function D(e,t){-1===e.$$.dirty[0]&&(w.push(e),A||(A=!0,k.then(E)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function B(t,r,l,i,c,s,u=[-1]){const f=b;y(t);const d=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:r.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let p=!1;if(d.ctx=l?l(t,r.props||{},((e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&c(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),p&&D(t,e)),n})):[],d.update(),p=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);d.fragment&&d.fragment.l(e),e.forEach(a)}else d.fragment&&d.fragment.c();r.intro&&O(t.$$.fragment),M(t,r.target,r.anchor,r.customElement),E()}y(f)}class F{$destroy(){W(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}let Y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Y.decode();let J=null;function G(){return null!==J&&J.buffer===L.memory.buffer||(J=new Uint8Array(L.memory.buffer)),J}function V(e,t){return Y.decode(G().subarray(e,e+t))}const Q=new Array(32).fill(void 0);Q.push(void 0,null,!0,!1);let K=Q.length;function X(e){K===Q.length&&Q.push(Q.length+1);const t=K;return K=Q[t],Q[t]=e,t}function Z(e){return Q[e]}let ee=0,te=new TextEncoder("utf-8");const ne="function"==typeof te.encodeInto?function(e,t){return te.encodeInto(e,t)}:function(e,t){const n=te.encode(e);return t.set(n),{read:e.length,written:n.length}};function oe(e,t,n){if(ArrayBuffer.isView(e)){const n=e.byteLength,o=t(n);return G().set(e,o),ee=n,o}if(void 0===n){const n=te.encode(e),o=t(n.length);return G().subarray(o,o+n.length).set(n),ee=n.length,o}let o=e.length,r=t(o);const l=G();let i=0;for(;i<o;i++){const t=e.charCodeAt(i);if(t>127)break;l[r+i]=t}if(i!==o){0!==i&&(e=e.slice(i)),r=n(r,o,o=i+3*e.length);const t=G().subarray(r+i,r+o);i+=ne(e,t).written}return ee=i,r}let re=null;function le(){return null!==re&&re.buffer===L.memory.buffer||(re=new Int32Array(L.memory.buffer)),re}function ie(e){const t=Z(e);return function(e){e<36||(Q[e]=K,K=e)}(e),t}function ce(e){var t=oe(e,L.__wbindgen_malloc,L.__wbindgen_realloc),n=ee;return ie(L.parse(t,n))}let ae=32;function se(e){try{const o=L.__wbindgen_export_2.value-16;L.__wbindgen_export_2.value=o,L.stringify(o,function(e){if(1==ae)throw new Error("out of js stack");return Q[--ae]=e,ae}(e));var t=le()[o/4+0],n=le()[o/4+1];return V(t,n)}finally{L.__wbindgen_export_2.value+=16,Q[ae++]=void 0,L.__wbindgen_free(t,n)}}async function ue(e){void 0===e&&(e=import.meta.url.replace(/\.js$/,"_bg.wasm"));const t={wbg:{}};t.wbg.__wbindgen_json_parse=function(e,t){return X(JSON.parse(V(e,t)))},t.wbg.__wbindgen_json_serialize=function(e,t){const n=Z(t);var o=oe(JSON.stringify(void 0===n?null:n),L.__wbindgen_malloc,L.__wbindgen_realloc),r=ee;le()[e/4+1]=r,le()[e/4+0]=o},t.wbg.__wbindgen_string_new=function(e,t){return X(V(e,t))},t.wbg.__wbindgen_rethrow=function(e){throw ie(e)},("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return L=n.exports,ue.__wbindgen_wasm_module=o,L}function fe(e){let t,n,o,r;return{c(){t=s("label"),n=u(e[2]),o=f(),r=s("input"),m(r,"name",e[0]),r.value=e[6],m(r,"type",e[4]),m(r,"autocomplete",e[1]),m(r,"placeholder",e[3]),r.required=e[5]},m(l,a){c(l,t,a),i(t,n),i(t,o),i(t,r),e[9](r)},p(e,t){4&t&&h(n,e[2]),1&t&&m(r,"name",e[0]),64&t&&r.value!==e[6]&&(r.value=e[6]),16&t&&m(r,"type",e[4]),2&t&&m(r,"autocomplete",e[1]),8&t&&m(r,"placeholder",e[3]),32&t&&(r.required=e[5])},d(n){n&&a(t),e[9](null)}}}function de(e){let t;return{c(){t=s("input"),m(t,"type",e[4]),m(t,"name",e[0]),t.value=e[6]},m(e,n){c(e,t,n)},p(e,n){16&n&&m(t,"type",e[4]),1&n&&m(t,"name",e[0]),64&n&&t.value!==e[6]&&(t.value=e[6])},d(e){e&&a(t)}}}function pe(t){let n;function o(e,t){return"hidden"===e[4]?de:fe}let r=o(t),l=r(t);return{c(){l.c(),n=d()},m(e,t){l.m(e,t),c(e,n,t)},p(e,[t]){r===(r=o(e))&&l?l.p(e,t):(l.d(1),l=r(e),l&&(l.c(),l.m(n.parentNode,n)))},i:e,o:e,d(e){l.d(e),e&&a(n)}}}function me(e,t,n){let o,{name:r}=t,{autocomplete:l="auto"}=t,{autofocus:i=!1}=t,{label:c=r}=t,{placeholder:a}=t,{type:s="text"}=t,{required:u=!1}=t,{value:f=""}=t;var d;return i&&(d=()=>o.focus(),$().$$.on_mount.push(d)),e.$$set=e=>{"name"in e&&n(0,r=e.name),"autocomplete"in e&&n(1,l=e.autocomplete),"autofocus"in e&&n(8,i=e.autofocus),"label"in e&&n(2,c=e.label),"placeholder"in e&&n(3,a=e.placeholder),"type"in e&&n(4,s=e.type),"required"in e&&n(5,u=e.required),"value"in e&&n(6,f=e.value)},[r,l,c,a,s,u,f,o,i,function(e){v[e?"unshift":"push"]((()=>{o=e,n(7,o)}))}]}class he extends F{constructor(e){super(),B(this,e,me,pe,l,{name:0,autocomplete:1,autofocus:8,label:2,placeholder:3,type:4,required:5,value:6})}}function ge(e){let t,n,o,l,u,d,h,g,b,y,$,w,v,x,_,k,A,C,I,j,E,P,T,U,L,S;return u=new he({props:{name:"Name",value:e[1],required:!0,autocomplete:"name"}}),h=new he({props:{name:"Title",value:e[2],autocomplete:"organization-title",autofocus:!0,required:!0}}),b=new he({props:{name:"Phone",value:e[3],type:"phone",placeholder:"International phone number (optional)"}}),$=new he({props:{name:"pictureUrl",value:e[4],type:"hidden"}}),v=new he({props:{name:"url.Facebook",value:e[5],type:"url",placeholder:"Public URL to your Facebook profile (optional)"}}),_=new he({props:{name:"url.LinkedIn",value:e[7],type:"url",placeholder:"Public URL to your LinkedIn profile (optional)"}}),A=new he({props:{name:"url.Medium",value:e[6],type:"url",placeholder:"Public URL to your Medium profile (optional)"}}),I=new he({props:{name:"url.Twitter",value:e[8],type:"url",placeholder:"Public URL to your Twitter profile (optional)"}}),E=new he({props:{name:"url.YouTube",value:e[9],type:"url",placeholder:"Public URL to your YouTube channel (optional)"}}),{c(){t=s("form"),n=s("fieldset"),o=s("legend"),o.textContent="Personal information",l=f(),q(u.$$.fragment),d=f(),q(h.$$.fragment),g=f(),q(b.$$.fragment),y=f(),q($.$$.fragment),w=f(),q(v.$$.fragment),x=f(),q(_.$$.fragment),k=f(),q(A.$$.fragment),C=f(),q(I.$$.fragment),j=f(),q(E.$$.fragment),P=f(),T=s("button"),T.textContent="Save my information",m(T,"type","submit")},m(a,s){c(a,t,s),i(t,n),i(n,o),i(n,l),M(u,n,null),i(n,d),M(h,n,null),i(n,g),M(b,n,null),i(n,y),M($,n,null),i(n,w),M(v,n,null),i(n,x),M(_,n,null),i(n,k),M(A,n,null),i(n,C),M(I,n,null),i(n,j),M(E,n,null),i(n,P),i(n,T),U=!0,L||(S=p(t,"submit",(function(){r(e[0])&&e[0].apply(this,arguments)})),L=!0)},p(t,[n]){e=t},i(e){U||(O(u.$$.fragment,e),O(h.$$.fragment,e),O(b.$$.fragment,e),O($.$$.fragment,e),O(v.$$.fragment,e),O(_.$$.fragment,e),O(A.$$.fragment,e),O(I.$$.fragment,e),O(E.$$.fragment,e),U=!0)},o(e){N(u.$$.fragment,e),N(h.$$.fragment,e),N(b.$$.fragment,e),N($.$$.fragment,e),N(v.$$.fragment,e),N(_.$$.fragment,e),N(A.$$.fragment,e),N(I.$$.fragment,e),N(E.$$.fragment,e),U=!1},d(e){e&&a(t),W(u),W(h),W(b),W($),W(v),W(_),W(A),W(I),W(E),L=!1,S()}}}function be(e,t,n){let{user:o}=t,{onsubmit:r}=t;const{Name:l,Title:i,Phone:c,pictureUrl:a}=o,{Facebook:s,Medium:u,LinkedIn:f,Twitter:d,YouTube:p}=o.url||{};return e.$$set=e=>{"user"in e&&n(10,o=e.user),"onsubmit"in e&&n(0,r=e.onsubmit)},[r,l,i,c,a,s,u,f,d,p,o]}class ye extends F{constructor(e){super(),B(this,e,be,ge,l,{user:10,onsubmit:0})}}var $e=[376,971,93,355,374,244,54,43,61,297,994,387,880,32,226,359,973,257,229,673,591,55,975,267,375,501,243,236,242,41,225,682,56,237,86,57,506,53,238,599,357,420,49,253,45,213,593,372,20,291,34,251,358,679,691,298,33,241,44,995,594,233,350,299,220,224,590,240,30,502,245,592,852,504,385,509,36,62,353,972,91,246,964,98,354,39,962,81,254,996,855,269,850,82,965,856,961,423,94,231,266,370,352,371,218,212,377,373,382,261,692,389,223,95,976,853,596,222,356,230,960,265,52,60,258,264,687,227,672,234,505,31,47,977,674,683,64,968,507,51,689,675,63,92,48,508,970,351,680,595,974,262,40,381,7,250,966,677,248,249,46,65,386,421,232,378,221,252,597,211,239,503,963,268,235,228,66,992,670,993,216,676,90,688,886,255,380,256,1,598,998,58,84,678,681,685,383,967,27,260,263,800,808,870,878,881,882,883,888,979];const we=new URL("./data/",import.meta.url);var ve=e=>fetch(new URL(`./${e}.json`,we)).then((e=>e.ok?e.json():Promise.reject(new Error(e.statusText))));async function xe(e){const[t,n,o]=await async function(e){const t="+"===e[0]?1:0;for(let n=t;n<e.length;n++){const o=Number(e.slice(t,n));if($e.includes(o))return[o,e.slice(n),await ve(o)]}return Promise.reject(new Error("Unable to find valid country code"))}(e);let r;for(const{leadingDigits:e,pattern:t,format:l}of o)if(new RegExp(`^(${e})`).test(n)){const e=new RegExp(`${t}$`);if(e.test(n)){r=n.replace(e,l);break}}return`+${t} ${r||n}`}function _e(e,t,n){const o=e.slice();return o[3]=t[n][0],o[4]=t[n][1],o}function ke(t){let n,o,r;return{c(){n=s("a"),o=s("img"),m(o,"width","26"),m(o,"alt",t[3]+" icon"),g(o,"border","0"),g(o,"height","26px"),g(o,"width","26px"),o.src!==(r=`https://e-comas.com/icons/${t[3].toLowerCase()}.jpg`)&&m(o,"src",r),m(n,"href",t[4]),m(n,"target","_blank"),m(n,"rel","noopener")},m(e,t){c(e,n,t),i(n,o)},p:e,d(e){e&&a(n)}}}function Ae(t){let n,o=t[1],r=[];for(let e=0;e<o.length;e+=1)r[e]=ke(_e(t,o,e));return{c(){n=s("div");for(let e=0;e<r.length;e+=1)r[e].c();m(n,"style",t[0])},m(e,t){c(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,[t]){if(2&t){let l;for(o=e[1],l=0;l<o.length;l+=1){const i=_e(e,o,l);r[l]?r[l].p(i,t):(r[l]=ke(i),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=o.length}1&t&&m(n,"style",e[0])},i:e,o:e,d(e){e&&a(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(r,e)}}}function Ce(e,t,n){let{links:o}=t,{style:r}=t;o.link="https://www.e-comas.com/";const l=Object.entries(o);return e.$$set=e=>{"links"in e&&n(2,o=e.links),"style"in e&&n(0,r=e.style)},[r,l,o]}class Ie extends F{constructor(e){super(),B(this,e,Ce,Ae,l,{links:2,style:0})}}function je(e){e[10]=e[12][0],e[11]=e[12][1]}function Ee(t){let n,o,r=t[13]+"";return{c(){n=s("p"),o=u(r),g(n,"color","red")},m(e,t){c(e,n,t),i(n,o)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Pe(t){let n,o,r,l,d,p,b,y,$,w,v,x,_,k,A,C,I,j,E,P,T,U,L,S,z,R,H,D,B,F,Y,J,G,V,Q,K,X,Z,ee,te;je(t);let ne=t[3]&&function(t){let n,o,r,l,f=t[10]+"";return{c(){n=s("tr"),o=s("td"),r=s("a"),l=u(f),m(r,"href","tel:"+t[3]),m(r,"target","_blank"),g(r,"color","#20262b"),g(r,"text-decoration","none"),g(o,"font-family","Arial, Helvetica, sans-serif"),g(o,"font-size","14px"),g(o,"vertical-align","top")},m(e,t){c(e,n,t),i(n,o),i(o,r),i(r,l)},p:e,d(e){e&&a(n)}}}(t);return Q=new Ie({props:{links:t[5],style:"display: flex; gap: 5px;"}}),{c(){n=s("table"),o=s("tbody"),r=s("tr"),l=s("td"),d=s("table"),p=s("tbody"),b=s("tr"),y=s("td"),$=s("img"),v=f(),x=s("td"),_=s("table"),k=s("tbody"),A=s("tr"),C=s("td"),I=s("strong"),I.textContent=`${t[1]}`,j=f(),E=s("tr"),P=s("td"),T=s("strong"),T.textContent=`${t[2]}`,U=f(),L=s("tr"),S=s("td"),z=s("a"),R=u(t[0]),D=f(),ne&&ne.c(),B=f(),F=s("tr"),Y=s("td"),Y.textContent=`${Le}`,J=f(),G=s("tr"),V=s("td"),q(Q.$$.fragment),K=f(),X=s("tr"),X.innerHTML='<td style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; vertical-align: top;"><table cellpadding="0" cellspacing="0" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: separate;"><tbody><tr><td style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; vertical-align: top;"><a href="https://www.e-comas.com/white-paper-form.html" target="_blank" rel="noopener" style="color: #20262b; text-decoration: none;"><img alt="Logo" width="540" height="90" src="https://www.e-comas.com/docs/signatures/ressources/how-to-manage-amazon.jpg" style="-ms-interpolation-mode: bicubic; max-width: 100%; height: auto; border: none; padding-right: 5px;"/></a></td></tr></tbody></table></td>',Z=f(),ee=s("style"),ee.textContent="#signature { text-align: initial; }",m($,"alt",t[1]+"'s picture"),m($,"width",t[11]),m($,"height",Se),$.src!==(w=t[4])&&m($,"src",w),g($,"-ms-interpolation-mode","bicubic"),g($,"max-width","100%"),g($,"height","auto"),g($,"border","none"),g($,"padding-right","5px"),g(y,"font-family","Arial, Helvetica, sans-serif"),g(y,"font-size","14px"),g(y,"vertical-align","top"),m(I,"class","name"),g(I,"color","#51bf9d"),g(C,"font-family","Arial, Helvetica, sans-serif"),g(C,"font-size","14px"),g(C,"vertical-align","top"),g(T,"color","#20262b"),g(P,"font-family","Arial, Helvetica, sans-serif"),g(P,"font-size","14px"),g(P,"vertical-align","top"),m(z,"href",H="mailto:"+t[0]),m(z,"target","_blank"),g(z,"color","#20262b"),g(z,"text-decoration","none"),g(S,"font-family","Arial, Helvetica, sans-serif"),g(S,"font-size","14px"),g(S,"vertical-align","top"),g(Y,"font-family","Arial, Helvetica, sans-serif"),g(Y,"font-size","14px"),g(Y,"vertical-align","top"),m(_,"cellpadding","0"),m(_,"cellspacing","5"),g(_,"mso-table-lspace","0pt"),g(_,"mso-table-rspace","0pt"),g(_,"border-collapse","separate"),g(x,"font-family","Arial, Helvetica, sans-serif"),g(x,"font-size","14px"),g(x,"vertical-align","top"),m(d,"cellpadding","0"),m(d,"cellspacing","0"),g(d,"mso-table-lspace","0pt"),g(d,"mso-table-rspace","0pt"),g(d,"border-collapse","separate"),g(l,"font-family","Arial, Helvetica, sans-serif"),g(l,"font-size","14px"),g(l,"vertical-align","top"),g(V,"font-family","Arial, Helvetica, sans-serif"),g(V,"font-size","14px"),g(V,"vertical-align","top"),m(n,"id","signature"),m(n,"cellpadding","0"),m(n,"cellspacing","0"),g(n,"mso-table-lspace","0pt"),g(n,"mso-table-rspace","0pt"),g(n,"width","640px"),g(n,"padding","0"),g(n,"font-family","Arial, Helvetica, sans-serif"),g(n,"-webkit-font-smoothing","antialiased"),g(n,"font-size","14px"),g(n,"-ms-text-size-adjust","100%"),g(n,"-webkit-text-size-adjust","100%"),g(n,"border-collapse","separate")},m(e,t){c(e,n,t),i(n,o),i(o,r),i(r,l),i(l,d),i(d,p),i(p,b),i(b,y),i(y,$),i(b,v),i(b,x),i(x,_),i(_,k),i(k,A),i(A,C),i(C,I),i(k,j),i(k,E),i(E,P),i(P,T),i(k,U),i(k,L),i(L,S),i(S,z),i(z,R),i(k,D),ne&&ne.m(k,null),i(k,B),i(k,F),i(F,Y),i(o,J),i(o,G),i(G,V),M(Q,V,null),i(o,K),i(o,X),c(e,Z,t),c(e,ee,t),te=!0},p(e,t){je(e),(!te||1&t)&&h(R,e[0]),(!te||1&t&&H!==(H="mailto:"+e[0]))&&m(z,"href",H),e[3]&&ne.p(e,t)},i(e){te||(O(Q.$$.fragment,e),te=!0)},o(e){N(Q.$$.fragment,e),te=!1},d(e){e&&a(n),ne&&ne.d(),W(Q),e&&a(Z),e&&a(ee)}}}function Te(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){c(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Ue(e){let t,n,o={ctx:e,current:null,token:null,hasCatch:!0,pending:Te,then:Pe,catch:Ee,value:12,error:13,blocks:[,,,]};return R(e[6],o),{c(){t=d(),o.block.c()},m(e,r){c(e,t,r),o.block.m(e,o.anchor=r),o.mount=()=>t.parentNode,o.anchor=t,n=!0},p(t,[n]){H(o,e=t,n)},i(e){n||(O(o.block),n=!0)},o(e){for(let e=0;e<3;e+=1){N(o.blocks[e])}n=!1},d(e){e&&a(t),o.block.d(e),o.token=null,o=null}}}const Le="e-Comas Sarl, 68 Avenue de la Liberté, 1930 Luxembourg",Se=105;function ze(e,t,n){var o;let{user:r}=t,{emailAddress:l}=t;const{Name:i,Title:c,Phone:a,pictureUrl:s}=r,u=null!==(o=r.url)&&void 0!==o?o:{},f=Promise.all([a?xe(a):Promise.resolve(),(e=>{const t=new Image;return t.src=e,t.decode().then((()=>t))})(s).then((e=>e.naturalWidth*(Se/e.naturalHeight)),(e=>(console.error(e),Se)))]);return e.$$set=e=>{"user"in e&&n(7,r=e.user),"emailAddress"in e&&n(0,l=e.emailAddress)},[l,i,c,a,s,u,f,r]}class Oe extends F{constructor(e){super(),B(this,e,ze,Ue,l,{user:7,emailAddress:0})}}function Ne(t){let n,r,l,i,u;return{c(){n=s("button"),n.textContent="Copy signature",r=f(),l=s("button"),l.textContent="Copy HTML code"},m(e,o){c(e,n,o),c(e,r,o),c(e,l,o),i||(u=[p(n,"click",t[0]),p(l,"click",t[1])],i=!0)},p:e,i:e,o:e,d(e){e&&a(n),e&&a(r),e&&a(l),i=!1,o(u)}}}function Re(e){const t=()=>document.getElementById("signature").outerHTML;return[function(e){e.preventDefault(),navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([t()],{type:"text/html"})})])},function(e){e.preventDefault(),navigator.clipboard.writeText(t())}]}class He extends F{constructor(e){super(),B(this,e,Re,Ne,l,{})}}function qe(e){e[8]=e[10][0],e[9]=e[10][1]}function Me(t){let n,o,r=t[11]+"";return{c(){n=s("p"),o=u(r),g(n,"color","red")},m(e,t){c(e,n,t),i(n,o)},p(e,t){1&t&&r!==(r=e[11]+"")&&h(o,r)},i:e,o:e,d(e){e&&a(n)}}}function We(e){let t,n,o,r;qe(e),t=new ye({props:{user:e[8],onsubmit:e[1]}});let l=!e[8].newUser&&De(e);return{c(){q(t.$$.fragment),n=f(),l&&l.c(),o=d()},m(e,i){M(t,e,i),c(e,n,i),l&&l.m(e,i),c(e,o,i),r=!0},p(e,n){qe(e);const r={};1&n&&(r.user=e[8]),t.$set(r),e[8].newUser?l&&(S(),N(l,1,1,(()=>{l=null})),z()):l?(l.p(e,n),1&n&&O(l,1)):(l=De(e),l.c(),O(l,1),l.m(o.parentNode,o))},i(e){r||(O(t.$$.fragment,e),O(l),r=!0)},o(e){N(t.$$.fragment,e),N(l),r=!1},d(e){W(t,e),e&&a(n),l&&l.d(e),e&&a(o)}}}function De(e){let t,n,o,r,l,i,u,d;return o=new Oe({props:{user:e[8],emailAddress:e[9]}}),u=new He({}),{c(){t=s("hr"),n=f(),q(o.$$.fragment),r=f(),l=s("hr"),i=f(),q(u.$$.fragment)},m(e,a){c(e,t,a),c(e,n,a),M(o,e,a),c(e,r,a),c(e,l,a),c(e,i,a),M(u,e,a),d=!0},p(e,t){const n={};1&t&&(n.user=e[8]),1&t&&(n.emailAddress=e[9]),o.$set(n)},i(e){d||(O(o.$$.fragment,e),O(u.$$.fragment,e),d=!0)},o(e){N(o.$$.fragment,e),N(u.$$.fragment,e),d=!1},d(e){e&&a(t),e&&a(n),W(o,e),e&&a(r),e&&a(l),e&&a(i),W(u,e)}}}function Be(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){c(e,n,t)},p:e,i:e,o:e,d(e){e&&a(n)}}}function Fe(e){let t,n,o,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Be,then:We,catch:Me,value:10,error:11,blocks:[,,,]};return R(n=e[0],r),{c(){t=d(),r.block.c()},m(e,n){c(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t,o=!0},p(t,[o]){e=t,r.ctx=e,1&o&&n!==(n=e[0])&&R(n,r)||H(r,e,o)},i(e){o||(O(r.block),o=!0)},o(e){for(let e=0;e<3;e+=1){N(r.blocks[e])}o=!1},d(e){e&&a(t),r.block.d(e),r.token=null,r=null}}}const Ye="1YrdCY5heoUS2eLGvU8-YsIspk9ez42glfd-hWRUxo2Q";function Je(e){if(e&&"object"==typeof e)return e.content?e.content:Object.values(e).map(Je).join("\n")}function Ge(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,l){function i(e){try{a(o.next(e))}catch(e){l(e)}}function c(e){try{a(o.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((o=o.apply(e,t||[])).next())}))};function*r(e,t){yield"",yield"";const n=[];yield se({[e]:Object.fromEntries(Object.entries(t).filter((([e,t])=>!!t&&(!("object"==typeof t&&!Array.isArray(t))||(n.push(function*(e,t){for(const[n,o]of Object.entries(t))o&&(yield`${e}.${se({[n]:o})}`)}(e,t)),!1)))))}).trimEnd();for(const e of n)yield*e}const l=(e,t)=>Object.entries(t).some((([t,n])=>"object"==typeof n?l(e[t],n):e[t]!==n)),i=(e,t)=>{if(t.includes(".")){const[n,o]=t.split(".",2);return e[n][o]}return e[t]},c=(e,t,n="")=>Object.entries(e).flatMap((([e,o])=>o&&o!==t[e]?"string"==typeof o||Array.isArray(o)?{entry:[`${n}${e}`,o]}:c(o,t[e],`${e}.`):[]));let a=Promise.all([ue("build/5bb3b01f8af02723.wasm"),gapi.client.docs.documents.get({documentId:Ye}),location.hash.includes("@")?Promise.resolve({result:{email:location.hash.slice(1)}}):gapi.client.request({method:"GET",path:"/userinfo/v2/me"})]).then((([e,t,n])=>{var o;return[null!==(o=ce(Je(t.result.body.content))[n.result.email])&&void 0!==o?o:{Name:n.result.name,newUser:!0},n.result.email]}));return window.addEventListener("hashchange",(()=>{if(location.hash.includes("@")){const e=location.hash.slice(1);n(0,a=gapi.client.docs.documents.get({documentId:Ye}).then((t=>{var n;return[null!==(n=ce(Je(t.result.body.content))[e])&&void 0!==n?n:{newUser:!0},e]})))}})),[a,function(e){var t;return o(this,void 0,void 0,(function*(){e.preventDefault();const o=[],[s,u]=yield a,f={};for(const[e,n]of new FormData(this).entries())if(e.includes(".")){const[o,r]=e.split(".",2);null!==(t=f[o])&&void 0!==t||(f[o]={}),f[o][r]=n}else f[e]="Phone"===e&&""!==n?"+"+/\D/g[Symbol.replace](n,""):n;if(s.newUser){f.pictureUrl=`https://www.e-comas.com/docs/signatures/ressources/${u.substring(0,u.indexOf("@"))}.jpg`,s.newUser=!1;const e=[...r(u,f)].join("\n");o.push({insertText:{text:e,endOfSegmentLocation:{segmentId:""}}}),n(0,a=Promise.resolve([ce(e)[u],u]))}else if(JSON.stringify(s)!==JSON.stringify(f)){const e=(yield gapi.client.docs.documents.get({documentId:Ye})).result.body.content.flatMap((e=>{var t,n;return null!==(n=null===(t=e.paragraph)||void 0===t?void 0:t.elements.map((({startIndex:e,endIndex:t,textRun:n})=>({startIndex:e,endIndex:t,text:n.content}))))&&void 0!==n?n:[]})),t=/^\s*\["[^"]+@[^"]+"\]\s*$/,r=/\S/;let d,p=!1;for(const{startIndex:n,endIndex:c,text:a}of e)if(r.test(a)){if(t.test(a)){if(p)break;a.trim()===`[${se(u)}]`&&(p=!0)}else if(p&&(d=c,l(f,ce(a)))){const e=a.slice(0,a.indexOf("=")).trim(),t=i(f,e);""===t?delete s[e]:s[e]=t,o.unshift({deleteContentRange:{range:{segmentId:"",startIndex:n,endIndex:c}}},""===t?void 0:{insertText:{location:{index:n,segmentId:""},text:`${e} = ${se(t)}\n`}})}}else;for(const{entry:[e,t]}of c(f,s))s[e]=t,o.unshift({insertText:{location:{index:d,segmentId:""},text:`${e} = ${se(t)}\n`}});n(0,a=Promise.resolve([s,u]))}o.length&&(yield gapi.client.docs.documents.batchUpdate({documentId:Ye,requests:o}))}))}]}class Ve extends F{constructor(e){super(),B(this,e,Ge,Fe,l,{})}}function Qe(t){let n;return{c(){n=s("p"),n.textContent="Unable to connect to Google API.",g(n,"color","red")},m(e,t){c(e,n,t)},p:e,d(e){e&&a(n)}}}function Ke(e){let t;function n(e,t){return e[1]?Ze:Xe}let o=n(e),r=o(e);return{c(){r.c(),t=d()},m(e,n){r.m(e,n),c(e,t,n)},p(e,l){o===(o=n(e))&&r?r.p(e,l):(r.d(1),r=o(e),r&&(r.c(),r.m(t.parentNode,t)))},d(e){r.d(e),e&&a(t)}}}function Xe(e){let t,n,o,r;function l(e,t){return e[0]?tt:et}let u=l(e),f=u(e);return{c(){t=s("p"),n=s("button"),f.c()},m(l,a){c(l,t,a),i(t,n),f.m(n,null),o||(r=p(n,"click",e[7]),o=!0)},p(t,o){u!==(u=l(e=t))&&(f.d(1),f=u(e),f&&(f.c(),f.m(n,null)))},d(e){e&&a(t),f.d(),o=!1,r()}}}function Ze(e){let t,n,o={ctx:e,current:null,token:null,hasCatch:!0,pending:rt,then:ot,catch:nt,error:8};return R(n=e[1],o),{c(){t=d(),o.block.c()},m(e,n){c(e,t,n),o.block.m(e,o.anchor=n),o.mount=()=>t.parentNode,o.anchor=t},p(t,r){e=t,o.ctx=e,2&r&&n!==(n=e[1])&&R(n,o)||H(o,e,r)},d(e){e&&a(t),o.block.d(e),o.token=null,o=null}}}function et(e){let t;return{c(){t=u("Sign in")},m(e,n){c(e,t,n)},d(e){e&&a(t)}}}function tt(e){let t;return{c(){t=u("Sign out")},m(e,n){c(e,t,n)},d(e){e&&a(t)}}}function nt(e){let t,n,r,l,d,m,b,y,$,w,v=(e[8].message||e[8].error||"Error")+"";return{c(){t=s("p"),n=u("An error occured: "),r=u(v),l=u("."),d=f(),m=s("button"),m.textContent="Try again",b=f(),y=s("button"),y.textContent="Cancel",g(t,"color","red")},m(o,a){c(o,t,a),i(t,n),i(t,r),i(t,l),c(o,d,a),c(o,m,a),c(o,b,a),c(o,y,a),$||(w=[p(m,"click",e[7]),p(y,"click",e[2])],$=!0)},p(t,n){e=t,2&n&&v!==(v=(e[8].message||e[8].error||"Error")+"")&&h(r,v)},d(e){e&&a(t),e&&a(d),e&&a(m),e&&a(b),e&&a(y),$=!1,o(w)}}}function ot(t){return{c:e,m:e,p:e,d:e}}function rt(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){c(e,n,t)},p:e,d(e){e&&a(n)}}}function lt(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){c(e,n,t)},p:e,d(e){e&&a(n)}}}function it(e){let t,n;return t=new Ve({}),{c(){q(t.$$.fragment)},m(e,o){M(t,e,o),n=!0},i(e){n||(O(t.$$.fragment,e),n=!0)},o(e){N(t.$$.fragment,e),n=!1},d(e){W(t,e)}}}function ct(e){let t,n,o,r,l,u={ctx:e,current:null,token:null,hasCatch:!0,pending:lt,then:Ke,catch:Qe,value:7,error:8};R(e[3],u);let d=e[0]&&it();return{c(){t=s("main"),n=s("h1"),n.textContent="Email signature tool",o=f(),u.block.c(),r=f(),d&&d.c(),m(n,"class","svelte-p9rgeo"),m(t,"class","svelte-p9rgeo")},m(e,a){c(e,t,a),i(t,n),i(t,o),u.block.m(t,u.anchor=null),u.mount=()=>t,u.anchor=r,i(t,r),d&&d.m(t,null),l=!0},p(n,[o]){H(u,e=n,o),e[0]?d?1&o&&O(d,1):(d=it(),d.c(),O(d,1),d.m(t,null)):d&&(S(),N(d,1,1,(()=>{d=null})),z())},i(e){l||(O(d),l=!0)},o(e){N(d),l=!1},d(e){e&&a(t),u.block.d(),u.token=null,u=null,d&&d.d()}}}function at(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,l){function i(e){try{a(o.next(e))}catch(e){l(e)}}function c(e){try{a(o.throw(e))}catch(e){l(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((o=o.apply(e,t||[])).next())}))},r=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){(function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)})(o,r,(t=e[n](t)).done,t.value)}))}}};let l,i;const c=import("./gdocs-49da909e.js").then((e=>{const t=e.subscribeToConnectionStatus(),c=t.next();return function(e){var t,c,a,s;o(this,void 0,void 0,(function*(){try{for(t=r(e);!(c=yield t.next()).done;){const e=c.value;n(0,l=e),n(1,i=null)}}catch(e){a={error:e}}finally{try{c&&!c.done&&(s=t.return)&&(yield s.call(t))}finally{if(a)throw a.error}}}))}(t),c.then((t=>(n(0,l=t.value),()=>{n(1,i=new Promise(((t,n)=>(l?e.disconnect():e.connect()).then(t,n))))})))}));return[l,i,function(){n(1,i=null)},c]}const st=new class extends F{constructor(e){super(),B(this,e,at,ct,l,{})}}({target:document.body,props:{}});export default st;
//# sourceMappingURL=main.js.map
