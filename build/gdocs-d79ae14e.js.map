{"version":3,"file":"gdocs-d79ae14e.js","sources":["../../src/gdocs.js"],"sourcesContent":["// Client ID and API key from the Developer Console\nvar CLIENT_ID =\n  \"574901819149-d46caor3hasi3bsngfua2q20idump433.apps.googleusercontent.com\";\nvar CLIENT_SECRET = \"5wwG1T1fW1hyaClNMG7TSYPM\";\nvar API_KEY = \"AIzaSyDIzIuLKqaQhWXSykVOWOQLqlLggFTDOh8\";\n\n// Array of API discovery doc URLs for APIs used by the quickstart\nvar DISCOVERY_DOCS = [\"https://docs.googleapis.com/$discovery/rest?version=v1\"];\n\n// Authorization scopes required by the API; multiple scopes can be\n// included, separated by spaces.\nvar SCOPES = \"https://www.googleapis.com/auth/documents.readonly\";\n\n/**\n *  On load, called to load the auth2 library and API client library.\n */\nfunction handleClientLoad() {\n  return gapi.load(\"client:auth2\", initClient);\n}\n\n/**\n *  Initializes the API client library and sets up sign-in state\n *  listeners.\n */\nasync function initClient() {\n  while (!(\"client\" in gapi)) await new Promise((d) => setTimeout(d, 0));\n\n  console.log(\"client available\");\n  await gapi.client.init({\n    apiKey: API_KEY,\n    clientId: CLIENT_ID,\n    discoveryDocs: DISCOVERY_DOCS,\n    scope: SCOPES,\n  });\n  console.log(\"client initialized\");\n  // Listen for sign-in state changes.\n  gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);\n\n  // Handle the initial sign-in state.\n  updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());\n}\n\nlet connectStatusPromise,\n  connectStatus,\n  resolveConnectStatus = Function.prototype;\nfunction updateSigninStatus(isSignedIn) {\n  console.log(\"status\", isSignedIn);\n  connectStatus = isSignedIn;\n  connectStatusPromise = new Promise((resolve) => {\n    resolveConnectStatus(isSignedIn);\n    resolveConnectStatus = resolve;\n  });\n}\nupdateSigninStatus(undefined); // Initialize connection status\nexport async function* subscribeToConnectionStatus() {\n  console.log(\"subscribe\", connectStatus);\n  if (connectStatus !== undefined) yield connectStatus;\n  console.log(\"yield?\", connectStatus);\n  while (true) {\n    console.log(\"await before\", connectStatus);\n    const status = await connectStatusPromise;\n    console.log(\"await after\", connectStatus);\n    yield status;\n  }\n}\n\n/**\n *  Sign in the user upon button click.\n */\nexport function connect() {\n  console.log(\"connect\");\n  return gapi.auth2.getAuthInstance().signIn();\n}\n\n/**\n *  Sign out the user upon button click.\n */\nexport function disconnect() {\n  console.log(\"disconnect\");\n  return gapi.auth2.getAuthInstance().signOut();\n}\n\n/**\n * Prints the title of a sample doc:\n * https://docs.google.com/document/d/195j9eDD3ccgjQRttHhJPymLJUCOUjs-jmwTrekvdjFE/edit\n */\nfunction printDocTitle() {\n  return gapi.client.docs.documents\n    .get({\n      documentId: \"1jo9ZKaiif5SdYLitw8tmJk8Bis_Zw0GWHkyvndhU7XI\",\n    })\n    .then(\n      function (response) {\n        // debugger;\n        postMessage({ response });\n      },\n      function (response) {\n        console.error(response);\n      }\n    );\n}\n\nimport \"https://apis.google.com/js/api.js\";\nhandleClientLoad();\n"],"names":["DISCOVERY_DOCS","async","initClient","gapi","Promise","d","setTimeout","console","log","client","init","apiKey","clientId","discoveryDocs","scope","auth2","getAuthInstance","isSignedIn","listen","updateSigninStatus","get","connectStatusPromise","connectStatus","resolveConnectStatus","Function","prototype","resolve","subscribeToConnectionStatus","undefined","status","connect","signIn","disconnect","signOut","load"],"mappings":"0CACA,IAMIA,EAAiB,CAAC,0DAiBtBC,eAAeC,IACb,OAAS,WAAYC,aAAa,IAAIC,SAASC,GAAMC,WAAWD,EAAG,KAEnEE,QAAQC,IAAI,0BACNL,KAAKM,OAAOC,KAAK,CACrBC,OAzBU,0CA0BVC,SA5BF,2EA6BEC,cAAeb,EACfc,MArBS,uDAuBXP,QAAQC,IAAI,sBAEZL,KAAKY,MAAMC,kBAAkBC,WAAWC,OAAOC,GAG/CA,EAAmBhB,KAAKY,MAAMC,kBAAkBC,WAAWG,OAG7D,IAAIC,EACFC,EACAC,EAAuBC,SAASC,UAClC,SAASN,EAAmBF,GAC1BV,QAAQC,IAAI,SAAUS,GACtBK,EAAgBL,EAChBI,EAAuB,IAAIjB,SAASsB,IAClCH,EAAqBN,GACrBM,EAAuBG,KAIpBzB,eAAgB0B,IAIrB,IAHApB,QAAQC,IAAI,YAAac,QACHM,IAAlBN,UAAmCA,GACvCf,QAAQC,IAAI,SAAUc,KACT,CACXf,QAAQC,IAAI,eAAgBc,GAC5B,MAAMO,QAAeR,EACrBd,QAAQC,IAAI,cAAec,SACrBO,GAOH,SAASC,IAEd,OADAvB,QAAQC,IAAI,WACLL,KAAKY,MAAMC,kBAAkBe,SAM/B,SAASC,IAEd,OADAzB,QAAQC,IAAI,cACLL,KAAKY,MAAMC,kBAAkBiB,UA1BtCd,OAAmBS,GApCVzB,KAAK+B,KAAK,eAAgBhC"}