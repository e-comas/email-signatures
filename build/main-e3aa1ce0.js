function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function a(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function d(){return u(" ")}function f(){return u("")}function m(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function g(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}let b;function y(t){b=t}function w(){if(!b)throw new Error("Function called outside component initialization");return b}const x=[],v=[],$=[],k=[],_=Promise.resolve();let C=!1;function A(t){$.push(t)}let I=!1;const z=new Set;function E(){if(!I){I=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];y(e),j(e.$$)}for(y(null),x.length=0;v.length;)v.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];z.has(e)||(z.add(e),e())}$.length=0}while(x.length);for(;k.length;)k.pop()();C=!1,I=!1,z.clear()}}function j(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const L=new Set;let T,P;function U(){T={r:0,c:[],p:T}}function H(){T.r||o(T.c),T=T.p}function O(t,e){t&&t.i&&(L.delete(t),t.i(e))}function S(t,e,n,o){if(t&&t.o){if(L.has(t))return;L.add(t),T.c.push((()=>{L.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function N(t,e){const n=e.token={};function o(t,o,r,i){if(e.token!==n)return;e.resolved=i;let l=e.ctx;void 0!==r&&(l=l.slice(),l[r]=i);const s=t&&(e.current=t)(l);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(U(),S(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),H())})):e.block.d(1),s.c(),O(s,1),s.m(e.mount(),e.anchor),c=!0),e.block=s,e.blocks&&(e.blocks[o]=s),c&&E()}if((r=t)&&"object"==typeof r&&"function"==typeof r.then){const n=w();if(t.then((t=>{y(n),o(e.then,1,e.value,t),y(null)}),(t=>{if(y(n),o(e.catch,2,e.error,t),y(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}else{if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}var r}function M(t,e,n){const o=e.slice(),{resolved:r}=t;t.current===t.then&&(o[t.value]=r),t.current===t.catch&&(o[t.error]=r),t.block.p(o,n)}function q(t){t&&t.c()}function R(t,n,i,l){const{fragment:s,on_mount:c,on_destroy:a,after_update:u}=t.$$;s&&s.m(n,i),l||A((()=>{const n=c.map(e).filter(r);a?a.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(A)}function D(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(x.push(t),C||(C=!0,_.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(e,r,i,l,s,a,u=[-1]){const d=b;y(e);const f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:r.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let m=!1;if(f.ctx=i?i(e,r.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return f.ctx&&s(f.ctx[t],f.ctx[t]=r)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](r),m&&W(e,t)),n})):[],f.update(),m=!0,o(f.before_update),f.fragment=!!l&&l(f.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);f.fragment&&f.fragment.l(t),t.forEach(c)}else f.fragment&&f.fragment.c();r.intro&&O(e.$$.fragment),R(e,r.target,r.anchor,r.customElement),E()}y(d)}class J{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}let F=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});F.decode();let G=null;function Y(){return null!==G&&G.buffer===P.memory.buffer||(G=new Uint8Array(P.memory.buffer)),G}function V(t,e){return F.decode(Y().subarray(t,t+e))}const K=new Array(32).fill(void 0);K.push(void 0,null,!0,!1);let Q=K.length;function X(t){Q===K.length&&K.push(K.length+1);const e=Q;return Q=K[e],K[e]=t,e}function Z(t){return K[t]}let tt=0,et=new TextEncoder("utf-8");const nt="function"==typeof et.encodeInto?function(t,e){return et.encodeInto(t,e)}:function(t,e){const n=et.encode(t);return e.set(n),{read:t.length,written:n.length}};function ot(t,e,n){if(ArrayBuffer.isView(t)){const n=t.byteLength,o=e(n);return Y().set(t,o),tt=n,o}if(void 0===n){const n=et.encode(t),o=e(n.length);return Y().subarray(o,o+n.length).set(n),tt=n.length,o}let o=t.length,r=e(o);const i=Y();let l=0;for(;l<o;l++){const e=t.charCodeAt(l);if(e>127)break;i[r+l]=e}if(l!==o){0!==l&&(t=t.slice(l)),r=n(r,o,o=l+3*t.length);const e=Y().subarray(r+l,r+o);l+=nt(t,e).written}return tt=l,r}let rt=null;function it(){return null!==rt&&rt.buffer===P.memory.buffer||(rt=new Int32Array(P.memory.buffer)),rt}function lt(t){const e=Z(t);return function(t){t<36||(K[t]=Q,Q=t)}(t),e}function st(t){var e=ot(t,P.__wbindgen_malloc,P.__wbindgen_realloc),n=tt;return lt(P.parse(e,n))}let ct=32;function at(t){try{const o=P.__wbindgen_export_2.value-16;P.__wbindgen_export_2.value=o,P.stringify(o,function(t){if(1==ct)throw new Error("out of js stack");return K[--ct]=t,ct}(t));var e=it()[o/4+0],n=it()[o/4+1];return V(e,n)}finally{P.__wbindgen_export_2.value+=16,K[ct++]=void 0,P.__wbindgen_free(e,n)}}async function ut(t){void 0===t&&(t=import.meta.url.replace(/\.js$/,"_bg.wasm"));const e={wbg:{}};e.wbg.__wbindgen_json_parse=function(t,e){return X(JSON.parse(V(t,e)))},e.wbg.__wbindgen_json_serialize=function(t,e){const n=Z(e);var o=ot(JSON.stringify(void 0===n?null:n),P.__wbindgen_malloc,P.__wbindgen_realloc),r=tt;it()[t/4+1]=r,it()[t/4+0]=o},e.wbg.__wbindgen_string_new=function(t,e){return X(V(t,e))},e.wbg.__wbindgen_rethrow=function(t){throw lt(t)},("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:o}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}(await t,e);return P=n.exports,ut.__wbindgen_wasm_module=o,P}function dt(t){let e,n,o,r;return{c(){e=a("label"),n=u(t[2]),o=d(),r=a("input"),p(r,"name",t[0]),r.value=t[6],p(r,"type",t[4]),p(r,"autocomplete",t[1]),p(r,"placeholder",t[3]),r.required=t[5]},m(i,c){s(i,e,c),l(e,n),l(e,o),l(e,r),t[9](r)},p(t,e){4&e&&h(n,t[2]),1&e&&p(r,"name",t[0]),64&e&&r.value!==t[6]&&(r.value=t[6]),16&e&&p(r,"type",t[4]),2&e&&p(r,"autocomplete",t[1]),8&e&&p(r,"placeholder",t[3]),32&e&&(r.required=t[5])},d(n){n&&c(e),t[9](null)}}}function ft(t){let e;return{c(){e=a("input"),p(e,"type",t[4]),p(e,"name",t[0]),e.value=t[6]},m(t,n){s(t,e,n)},p(t,n){16&n&&p(e,"type",t[4]),1&n&&p(e,"name",t[0]),64&n&&e.value!==t[6]&&(e.value=t[6])},d(t){t&&c(e)}}}function mt(e){let n;function o(t,e){return"hidden"===t[4]?ft:dt}let r=o(e),i=r(e);return{c(){i.c(),n=f()},m(t,e){i.m(t,e),s(t,n,e)},p(t,[e]){r===(r=o(t))&&i?i.p(t,e):(i.d(1),i=r(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){i.d(t),t&&c(n)}}}function pt(t,e,n){let o,{name:r}=e,{autocomplete:i="auto"}=e,{autofocus:l=!1}=e,{label:s=r}=e,{placeholder:c}=e,{type:a="text"}=e,{required:u=!1}=e,{value:d=""}=e;var f;return l&&(f=()=>o.focus(),w().$$.on_mount.push(f)),t.$$set=t=>{"name"in t&&n(0,r=t.name),"autocomplete"in t&&n(1,i=t.autocomplete),"autofocus"in t&&n(8,l=t.autofocus),"label"in t&&n(2,s=t.label),"placeholder"in t&&n(3,c=t.placeholder),"type"in t&&n(4,a=t.type),"required"in t&&n(5,u=t.required),"value"in t&&n(6,d=t.value)},[r,i,s,c,a,u,d,o,l,function(t){v[t?"unshift":"push"]((()=>{o=t,n(7,o)}))}]}class ht extends J{constructor(t){super(),B(this,t,pt,mt,i,{name:0,autocomplete:1,autofocus:8,label:2,placeholder:3,type:4,required:5,value:6})}}function gt(t){let e,n,o,i,u,f,h,g,b,y,w,x,v,$,k,_,C,A;return u=new ht({props:{name:"Name",value:t[1],required:!0,autocomplete:"name"}}),h=new ht({props:{name:"Title",value:t[2],autocomplete:"organization-title",autofocus:!0,required:!0}}),b=new ht({props:{name:"Phone",value:t[3],type:"phone",placeholder:"International phone number (optional)"}}),w=new ht({props:{name:"pictureUrl",value:t[4],type:"hidden"}}),v=new ht({props:{name:"LinkedIn",value:t[5],type:"url",placeholder:"Public URL to your LinkedIn profile (optional)"}}),{c(){e=a("form"),n=a("fieldset"),o=a("legend"),o.textContent="Personal information",i=d(),q(u.$$.fragment),f=d(),q(h.$$.fragment),g=d(),q(b.$$.fragment),y=d(),q(w.$$.fragment),x=d(),q(v.$$.fragment),$=d(),k=a("button"),k.textContent="Save my information",p(k,"type","submit")},m(c,a){s(c,e,a),l(e,n),l(n,o),l(n,i),R(u,n,null),l(n,f),R(h,n,null),l(n,g),R(b,n,null),l(n,y),R(w,n,null),l(n,x),R(v,n,null),l(n,$),l(n,k),_=!0,C||(A=m(e,"submit",(function(){r(t[0])&&t[0].apply(this,arguments)})),C=!0)},p(e,[n]){t=e},i(t){_||(O(u.$$.fragment,t),O(h.$$.fragment,t),O(b.$$.fragment,t),O(w.$$.fragment,t),O(v.$$.fragment,t),_=!0)},o(t){S(u.$$.fragment,t),S(h.$$.fragment,t),S(b.$$.fragment,t),S(w.$$.fragment,t),S(v.$$.fragment,t),_=!1},d(t){t&&c(e),D(u),D(h),D(b),D(w),D(v),C=!1,A()}}}function bt(t,e,n){let{user:o}=e,{onsubmit:r}=e;const{Name:i,Title:l,Phone:s,pictureUrl:c,LinkedIn:a}=o;return t.$$set=t=>{"user"in t&&n(6,o=t.user),"onsubmit"in t&&n(0,r=t.onsubmit)},[r,i,l,s,c,a,o]}class yt extends J{constructor(t){super(),B(this,t,bt,gt,i,{user:6,onsubmit:0})}}var wt=[376,971,93,355,374,244,54,43,61,297,994,387,880,32,226,359,973,257,229,673,591,55,975,267,375,501,243,236,242,41,225,682,56,237,86,57,506,53,238,599,357,420,49,253,45,213,593,372,20,291,34,251,358,679,691,298,33,241,44,995,594,233,350,299,220,224,590,240,30,502,245,592,852,504,385,509,36,62,353,972,91,246,964,98,354,39,962,81,254,996,855,269,850,82,965,856,961,423,94,231,266,370,352,371,218,212,377,373,382,261,692,389,223,95,976,853,596,222,356,230,960,265,52,60,258,264,687,227,672,234,505,31,47,977,674,683,64,968,507,51,689,675,63,92,48,508,970,351,680,595,974,262,40,381,7,250,966,677,248,249,46,65,386,421,232,378,221,252,597,211,239,503,963,268,235,228,66,992,670,993,216,676,90,688,886,255,380,256,1,598,998,58,84,678,681,685,383,967,27,260,263,800,808,870,878,881,882,883,888,979];const xt=new URL("./data/",import.meta.url);var vt=t=>fetch(new URL(`./${t}.json`,xt)).then((t=>t.ok?t.json():Promise.reject(new Error(t.statusText))));async function $t(t){const[e,n,o]=await async function(t){const e="+"===t[0]?1:0;for(let n=e;n<t.length;n++){const o=Number(t.slice(e,n));if(wt.includes(o))return[o,t.slice(n),await vt(o)]}return Promise.reject(new Error("Unable to find valid country code"))}(t);let r;for(const{leadingDigits:t,pattern:e,format:i}of o)if(new RegExp(`^(${t})`).test(n)){const t=new RegExp(`${e}$`);if(t.test(n)){r=n.replace(t,i);break}}return`+${e} ${r||n}`}function kt(t){t[13]=t[15][0],t[14]=t[15][1]}function _t(t,e,n){const o=t.slice();return o[16]=e[n],o}function Ct(e){let n,o,r=e[19]+"";return{c(){n=a("p"),o=u(r),g(n,"color","red")},m(t,e){s(t,n,e),l(n,o)},p:t,d(t){t&&c(n)}}}function At(e){let n,o,r,i,f,m,b,y,w,x,v,$,k,_,C,A,I,z,E,j,L,T,P,U,H,O,S,N,M,q,R,D,W,B,J,F,G,Y,V,K,Q,X,Z,tt,et,nt,ot,rt,it,lt,st,ct,at,ut,dt,ft,mt,pt,ht,gt,bt,yt,wt,xt,vt,$t,Ct,At,zt,Et,Ut,Ht,Ot,St,Nt,Mt;kt(e);let qt=e[5]&&function(e){let n,o,r,i;return{c(){n=a("a"),o=a("img"),i=u("\n                    |"),o.src!==(r="https://www.e-comas.com/docs/signatures/ressources/linkedin-alt.png")&&p(o,"src",r),p(o,"alt","LinkedIn account"),p(o,"width","20"),p(o,"height","20"),g(o,"-ms-interpolation-mode","bicubic"),g(o,"max-width","100%"),g(o,"height","auto"),g(o,"border","none"),g(o,"vertical-align","middle"),p(n,"href",e[5]),g(n,"color","#4d4d4d"),g(n,"font-weight","bold"),g(n,"text-decoration","none")},m(t,e){s(t,n,e),l(n,o),s(t,i,e)},p:t,d(t){t&&c(n),t&&c(i)}}}(e),Rt=e[3]&&function(e){let n,o,r,i=e[13]+"";return{c(){n=a("a"),o=u(i),r=u(" |"),p(n,"href",e[6]),g(n,"color","#4d4d4d"),g(n,"font-weight","bold"),g(n,"text-decoration","none")},m(t,e){s(t,n,e),l(n,o),s(t,r,e)},p:t,d(t){t&&c(n),t&&c(r)}}}(e),Dt=0!==e[10].length&&function(t){let e;return{c(){e=a("colgroup"),e.innerHTML='<col width="0"/>'},m(t,n){s(t,e,n)},d(t){t&&c(e)}}}(),Wt=e[10],Bt=[];for(let t=0;t<Wt.length;t+=1)Bt[t]=It(_t(e,Wt,t));return{c(){n=a("table"),o=a("style"),o.textContent="@media screen and (max-width: 645px) {\n          #signature > tbody > tr {\n            display: flex;\n            flex-direction: column;\n          }\n          #signature .company-info {\n            padding: 10px;\n          }\n          #signature .company-info > tbody > tr > td:first-child {\n            display: none;\n          }\n          #signature .company-info > tbody > tr > td,\n          #signature .company-info table {\n            width: 100%;\n          }\n          #signature img:first-of-type,\n          #signature .company-info img {\n            display: block;\n            margin: auto;\n          }\n        }",r=d(),i=a("tbody"),f=a("tr"),m=a("td"),b=a("img"),w=d(),x=a("td"),v=a("table"),$=a("tbody"),k=a("tr"),_=a("th"),_.textContent=`${e[1]}`,C=d(),A=a("tr"),I=a("td"),I.textContent=`${e[2]}`,z=d(),E=a("tr"),E.innerHTML='<td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td>',j=d(),L=a("tr"),T=a("td"),qt&&qt.c(),P=d(),Rt&&Rt.c(),U=d(),H=a("a"),O=u(e[0]),S=d(),N=a("tr"),N.innerHTML='<td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td>',M=d(),q=a("tr"),q.innerHTML='<td style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; vertical-align: top;"><address style="font-size: 12px; color: #4d4d4d; letter-spacing: 0; line-height: 15px; font-style: normal;">e-Comas Sarl, 68 Avenue de la Liberté,<br/>1930\n                      Luxembourg, LUXEMBOURG</address></td>',R=d(),D=a("tr"),D.innerHTML='<td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td>',W=d(),B=a("tr"),B.innerHTML='<td class="cta" style="font-family: Arial, Helvetica, sans-serif; vertical-align: top; font-size: 12px; line-height: 18px; color: #4d4d4d;">Download the e-Comas whitepaper:\n                    <a href="https://www.e-comas.com/white-paper-form.html" style="font-weight: bold; color: #64d7be; letter-spacing: 0;">When luxury meets the mass market</a>.</td>',J=d(),F=a("td"),F.textContent=" ",G=d(),Y=a("td"),V=a("table"),K=a("colgroup"),Q=a("col"),X=d(),Z=a("col"),tt=d(),et=a("col"),nt=d(),ot=a("tbody"),rt=a("tr"),it=a("td"),lt=a("img"),ct=d(),at=a("tr"),ut=a("td"),dt=a("img"),mt=d(),pt=a("td"),ht=a("table"),Dt&&Dt.c(),gt=d(),bt=a("tbody"),yt=a("tr"),wt=a("td"),xt=a("a"),vt=a("img"),Ct=d(),At=a("tr"),At.innerHTML='<td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td>',zt=d(),Et=a("tr");for(let t=0;t<Bt.length;t+=1)Bt[t].c();Ut=d(),Ht=a("td"),Ht.textContent=" ",Ot=d(),St=a("tr"),St.innerHTML='<td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td> \n                  <td class="empty" style="font-size: 14px; font-family: unset; line-height: 12px; vertical-align: unset;"> </td>',Nt=d(),Mt=a("style"),Mt.textContent="#signature { text-align: initial; }",p(b,"alt",e[1]+"'s picture"),p(b,"width",e[14]),p(b,"height",jt),b.src!==(y=e[4])&&p(b,"src",y),g(b,"-ms-interpolation-mode","bicubic"),g(b,"max-width","100%"),g(b,"height","auto"),g(b,"border","none"),g(m,"font-family","Arial, Helvetica, sans-serif"),g(m,"font-size","14px"),g(m,"vertical-align","middle"),g(m,"padding","20px"),p(_,"class","name"),g(_,"font-size","20px"),g(_,"line-height","25px"),g(_,"color","#64d7be"),g(_,"letter-spacing","0"),g(_,"text-align","left"),p(I,"class","title"),g(I,"font-family","Arial, Helvetica, sans-serif"),g(I,"vertical-align","top"),g(I,"font-size","12px"),g(I,"color","#4d4d4d"),g(I,"letter-spacing","0"),g(I,"line-height","18px"),p(H,"href",e[7]),g(H,"color","#4d4d4d"),g(H,"font-weight","bold"),g(H,"text-decoration","none"),p(T,"class","socials"),g(T,"font-family","Arial, Helvetica, sans-serif"),g(T,"vertical-align","top"),g(T,"line-height","20px"),g(T,"font-size","12px"),g(T,"letter-spacing","0"),p(v,"cellpadding","0"),p(v,"cellspacing","0"),g(v,"mso-table-lspace","0pt"),g(v,"mso-table-rspace","0pt"),g(v,"border-collapse","separate"),g(x,"font-family","Arial, Helvetica, sans-serif"),g(x,"font-size","14px"),g(x,"vertical-align","middle"),g(F,"font-family","Arial, Helvetica, sans-serif"),g(F,"font-size","14px"),g(F,"vertical-align","middle"),g(F,"padding","10px"),p(Q,"width",Pt),p(Z,"width",e[9].width),p(et,"width",Tt-e[9].width-Pt),p(lt,"alt",""),lt.src!==(st="https://www.e-comas.com/docs/signatures/ressources/top-right.png")&&p(lt,"src","https://www.e-comas.com/docs/signatures/ressources/top-right.png"),p(lt,"width",Tt),p(lt,"height","120"),g(lt,"-ms-interpolation-mode","bicubic"),g(lt,"max-width","100%"),g(lt,"height","auto"),g(lt,"border","none"),g(lt,"display","block"),p(it,"colspan","3"),g(it,"font-family","Arial, Helvetica, sans-serif"),g(it,"font-size","14px"),g(it,"vertical-align","top"),p(dt,"alt",""),dt.src!==(ft="https://www.e-comas.com/docs/signatures/ressources/bottom-left.png")&&p(dt,"src","https://www.e-comas.com/docs/signatures/ressources/bottom-left.png"),p(dt,"width",Pt),p(dt,"height","156"),g(dt,"-ms-interpolation-mode","bicubic"),g(dt,"max-width","100%"),g(dt,"height","auto"),g(dt,"border","none"),g(dt,"display","block"),p(ut,"rowspan","2"),g(ut,"font-family","Arial, Helvetica, sans-serif"),g(ut,"font-size","14px"),g(ut,"vertical-align","top"),p(vt,"alt",e[9].alt),p(vt,"width",e[9].width),p(vt,"height",e[9].height),vt.src!==($t=e[9].src)&&p(vt,"src",$t),g(vt,"-ms-interpolation-mode","bicubic"),g(vt,"max-width","100%"),g(vt,"height","auto"),g(vt,"border","none"),g(vt,"display","block"),p(xt,"href",Lt),p(wt,"colspan",2*e[10].length||1),g(wt,"font-family","Arial, Helvetica, sans-serif"),g(wt,"font-size","14px"),g(wt,"vertical-align","top"),p(ht,"cellpadding","0"),p(ht,"cellspacing","0"),g(ht,"mso-table-lspace","0pt"),g(ht,"mso-table-rspace","0pt"),g(ht,"border-collapse","separate"),g(pt,"font-family","Arial, Helvetica, sans-serif"),g(pt,"font-size","14px"),g(pt,"vertical-align","top"),p(Ht,"class","empty"),g(Ht,"font-size","14px"),g(Ht,"font-family","unset"),g(Ht,"line-height","12px"),g(Ht,"vertical-align","unset"),p(V,"cellpadding","0"),p(V,"cellspacing","0"),p(V,"class","company-info"),g(V,"mso-table-lspace","0pt"),g(V,"mso-table-rspace","0pt"),g(V,"background-color","#70dbc2"),g(V,"color","white"),g(V,"border-collapse","separate"),g(Y,"font-family","Arial, Helvetica, sans-serif"),g(Y,"font-size","14px"),g(Y,"vertical-align","middle"),p(n,"id","signature"),p(n,"cellpadding","0"),p(n,"cellspacing","0"),g(n,"mso-table-lspace","0pt"),g(n,"mso-table-rspace","0pt"),g(n,"padding","0"),g(n,"font-family","Arial, Helvetica, sans-serif"),g(n,"-webkit-font-smoothing","antialiased"),g(n,"font-size","14px"),g(n,"-ms-text-size-adjust","100%"),g(n,"-webkit-text-size-adjust","100%"),g(n,"border-collapse","separate")},m(t,e){s(t,n,e),l(n,o),l(n,r),l(n,i),l(i,f),l(f,m),l(m,b),l(f,w),l(f,x),l(x,v),l(v,$),l($,k),l(k,_),l($,C),l($,A),l(A,I),l($,z),l($,E),l($,j),l($,L),l(L,T),qt&&qt.m(T,null),l(T,P),Rt&&Rt.m(T,null),l(T,U),l(T,H),l(H,O),l($,S),l($,N),l($,M),l($,q),l($,R),l($,D),l($,W),l($,B),l(f,J),l(f,F),l(f,G),l(f,Y),l(Y,V),l(V,K),l(K,Q),l(K,X),l(K,Z),l(K,tt),l(K,et),l(V,nt),l(V,ot),l(ot,rt),l(rt,it),l(it,lt),l(ot,ct),l(ot,at),l(at,ut),l(ut,dt),l(at,mt),l(at,pt),l(pt,ht),Dt&&Dt.m(ht,null),l(ht,gt),l(ht,bt),l(bt,yt),l(yt,wt),l(wt,xt),l(xt,vt),l(bt,Ct),l(bt,At),l(bt,zt),l(bt,Et);for(let t=0;t<Bt.length;t+=1)Bt[t].m(Et,null);l(at,Ut),l(at,Ht),l(ot,Ot),l(ot,St),s(t,Nt,e),s(t,Mt,e)},p(t,e){if(kt(t),t[5]&&qt.p(t,e),t[3]&&Rt.p(t,e),1&e&&h(O,t[0]),1024&e){let n;for(Wt=t[10],n=0;n<Wt.length;n+=1){const o=_t(t,Wt,n);Bt[n]?Bt[n].p(o,e):(Bt[n]=It(o),Bt[n].c(),Bt[n].m(Et,null))}for(;n<Bt.length;n+=1)Bt[n].d(1);Bt.length=Wt.length}},d(t){t&&c(n),qt&&qt.d(),Rt&&Rt.d(),Dt&&Dt.d(),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(Bt,t),t&&c(Nt),t&&c(Mt)}}}function It(e){let n,o,r,i,u,f,m;return{c(){n=a("td"),n.textContent=" ",o=d(),r=a("td"),i=a("a"),u=a("img"),m=d(),p(n,"class","empty"),g(n,"font-size","14px"),g(n,"font-family","unset"),g(n,"line-height","12px"),g(n,"vertical-align","unset"),u.src!==(f=e[16].src)&&p(u,"src",f),p(u,"alt",e[16].alt),p(u,"width","20"),p(u,"height","20"),g(u,"-ms-interpolation-mode","bicubic"),g(u,"max-width","100%"),g(u,"height","auto"),g(u,"border","none"),g(u,"display","block"),p(i,"href",e[16].href),p(r,"width","25"),g(r,"font-family","Arial, Helvetica, sans-serif"),g(r,"font-size","14px"),g(r,"vertical-align","top")},m(t,e){s(t,n,e),s(t,o,e),s(t,r,e),l(r,i),l(i,u),l(r,m)},p:t,d(t){t&&c(n),t&&c(o),t&&c(r)}}}function zt(e){let n;return{c(){n=a("p"),n.textContent="...loading"},m(t,e){s(t,n,e)},p:t,d(t){t&&c(n)}}}function Et(e){let n,o={ctx:e,current:null,token:null,hasCatch:!0,pending:zt,then:At,catch:Ct,value:15,error:19};return N(e[8],o),{c(){n=f(),o.block.c()},m(t,e){s(t,n,e),o.block.m(t,o.anchor=e),o.mount=()=>n.parentNode,o.anchor=n},p(t,[n]){M(o,e=t,n)},i:t,o:t,d(t){t&&c(n),o.block.d(t),o.token=null,o=null}}}const jt=200,Lt="https://e-comas.com",Tt=276,Pt=107;function Ut(t,e,n){let{user:o}=e,{emailAddress:r}=e;const{Name:i,Title:l,Phone:s,pictureUrl:c,LinkedIn:a}=o,u="tel:"+s,d="mailto:"+r,f=Promise.all([s?$t(s):Promise.resolve(),(t=>{const e=new Image;return e.src=t,e.decode().then((()=>e))})(c).then((t=>t.naturalWidth*(jt/t.naturalHeight)),(t=>(console.error(t),jt)))]);return t.$$set=t=>{"user"in t&&n(11,o=t.user),"emailAddress"in t&&n(0,r=t.emailAddress)},[r,i,l,s,c,a,u,d,f,{alt:"e-Comas, eCommerce made simple",src:"https://www.e-comas.com/docs/signatures/ressources/logo.png",width:136,height:33},[{src:"https://www.e-comas.com/docs/signatures/ressources/linkedin.png",alt:"LinkedIn",href:"https://www.linkedin.com/company/e-comas/"},{src:"https://www.e-comas.com/docs/signatures/ressources/youtube.png",alt:"YouTube",href:"https://www.youtube.com/channel/UClCYdUcUs1zJk8O3a4lC9lw"},{src:"https://www.e-comas.com/docs/signatures/ressources/facebook.png",alt:"Facebook",href:"https://www.facebook.com/ecomas.ecommerce.made.simple/"},{src:"https://www.e-comas.com/docs/signatures/ressources/instagram.png",alt:"Instagram",href:"https://www.instagram.com/ecomas.ecommerce.made.simple/"}],o]}class Ht extends J{constructor(t){super(),B(this,t,Ut,Et,i,{user:11,emailAddress:0})}}function Ot(e){let n,r,i,l,u;return{c(){n=a("button"),n.textContent="Copy signature",r=d(),i=a("button"),i.textContent="Copy HTML code"},m(t,o){s(t,n,o),s(t,r,o),s(t,i,o),l||(u=[m(n,"click",e[0]),m(i,"click",e[1])],l=!0)},p:t,i:t,o:t,d(t){t&&c(n),t&&c(r),t&&c(i),l=!1,o(u)}}}function St(t){const e=()=>document.getElementById("signature").outerHTML;return[function(t){t.preventDefault(),navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([e()],{type:"text/html"})})])},function(t){t.preventDefault(),navigator.clipboard.writeText(e())}]}class Nt extends J{constructor(t){super(),B(this,t,St,Ot,i,{})}}var Mt={CLIENT_ID:"574901819149-d46caor3hasi3bsngfua2q20idump433.apps.googleusercontent.com",API_KEY:"AIzaSyCEZvYd800q-9sOcbd2RE6979tu43G2NJ8",documentId:"1fGE2MU0CrxxRaC-YrvPzk-3aqOsqfcIVQPOeFmkmMTI"};function qt(t){t[10]=t[12][0],t[11]=t[12][1]}function Rt(e){let n,o,r=(e[13]?e[13].message||(e[13].result?`${e[13].result.error.code} ${e[13].result.error.status}: ${e[13].result.error.message}`:e[13]):"Unknown error")+"";return{c(){n=a("p"),o=u(r),g(n,"color","red")},m(t,e){s(t,n,e),l(n,o)},p(t,e){1&e&&r!==(r=(t[13]?t[13].message||(t[13].result?`${t[13].result.error.code} ${t[13].result.error.status}: ${t[13].result.error.message}`:t[13]):"Unknown error")+"")&&h(o,r)},i:t,o:t,d(t){t&&c(n)}}}function Dt(t){let e,n,o,r;qt(t),e=new yt({props:{user:t[10],onsubmit:t[1]}});let i=!t[10].newUser&&Wt(t);return{c(){q(e.$$.fragment),n=d(),i&&i.c(),o=f()},m(t,l){R(e,t,l),s(t,n,l),i&&i.m(t,l),s(t,o,l),r=!0},p(t,n){qt(t);const r={};1&n&&(r.user=t[10]),e.$set(r),t[10].newUser?i&&(U(),S(i,1,1,(()=>{i=null})),H()):i?(i.p(t,n),1&n&&O(i,1)):(i=Wt(t),i.c(),O(i,1),i.m(o.parentNode,o))},i(t){r||(O(e.$$.fragment,t),O(i),r=!0)},o(t){S(e.$$.fragment,t),S(i),r=!1},d(t){D(e,t),t&&c(n),i&&i.d(t),t&&c(o)}}}function Wt(t){let e,n,o,r,i,l,u,f;return o=new Ht({props:{user:t[10],emailAddress:t[11]}}),u=new Nt({}),{c(){e=a("hr"),n=d(),q(o.$$.fragment),r=d(),i=a("hr"),l=d(),q(u.$$.fragment)},m(t,c){s(t,e,c),s(t,n,c),R(o,t,c),s(t,r,c),s(t,i,c),s(t,l,c),R(u,t,c),f=!0},p(t,e){const n={};1&e&&(n.user=t[10]),1&e&&(n.emailAddress=t[11]),o.$set(n)},i(t){f||(O(o.$$.fragment,t),O(u.$$.fragment,t),f=!0)},o(t){S(o.$$.fragment,t),S(u.$$.fragment,t),f=!1},d(t){t&&c(e),t&&c(n),D(o,t),t&&c(r),t&&c(i),t&&c(l),D(u,t)}}}function Bt(e){let n;return{c(){n=a("p"),n.textContent="...loading"},m(t,e){s(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}function Jt(t){let e,n,o,r={ctx:t,current:null,token:null,hasCatch:!0,pending:Bt,then:Dt,catch:Rt,value:12,error:13,blocks:[,,,]};return N(n=t[0],r),{c(){e=f(),r.block.c()},m(t,n){s(t,e,n),r.block.m(t,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(e,[o]){t=e,r.ctx=t,1&o&&n!==(n=t[0])&&N(n,r)||M(r,t,o)},i(t){o||(O(r.block),o=!0)},o(t){for(let t=0;t<3;t+=1){S(r.blocks[t])}o=!1},d(t){t&&c(e),r.block.d(t),r.token=null,r=null}}}function Ft(t){if(t&&"object"==typeof t)return t.content?t.content:Object.values(t).map(Ft).join("")}function Gt(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function l(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,s)}c((o=o.apply(t,e||[])).next())}))};const{documentId:r}=Mt;function*i(t,e){yield"",yield"";const n=[];yield at({[t]:Object.fromEntries(Object.entries(e).filter((([t,e])=>!!e&&(!("object"==typeof e&&!Array.isArray(e))||(n.push(function*(t,e){for(const[n,o]of Object.entries(e))o&&(yield`${t}.${at({[n]:o})}`)}(t,e)),!1)))))}).trimEnd();for(const t of n)yield*t}const l=(t,e)=>Object.entries(e).some((([e,n])=>{var o;return"object"==typeof n?l(null!==(o=t[e])&&void 0!==o?o:{},n):t[e]!==n})),s=(t,e)=>{var n;if(e.includes(".")){const[o,r]=e.split(".",2);return null===(n=t[o])||void 0===n?void 0:n[r]}return t[e]},c=(t,e,n="")=>Object.entries(t).flatMap((([t,o])=>{var r;return o&&o!==e[t]?"string"==typeof o||Array.isArray(o)?{entry:[`${n}${t}`,o]}:c(o,null!==(r=e[t])&&void 0!==r?r:e[t]={},`${t}.`):[]}));function a(t){return st(t.result.body.content.map(Ft).join("\n"))}let u=Promise.all([ut("build/5bb3b01f8af02723.wasm"),gapi.client.docs.documents.get({documentId:r}),location.hash.includes("@")?Promise.resolve({result:{email:location.hash.slice(1)}}):gapi.client.request({method:"GET",path:"/userinfo/v2/me"})]).then((([t,e,n])=>{var o;return[null!==(o=a(e)[n.result.email])&&void 0!==o?o:{Name:n.result.name,newUser:!0},n.result.email]}));return u.catch(console.error),window.addEventListener("hashchange",(()=>{if(location.hash.includes("@")){const t=location.hash.slice(1);n(0,u=gapi.client.docs.documents.get({documentId:r}).then((e=>{var n;return[null!==(n=a(e)[t])&&void 0!==n?n:{newUser:!0},t]})))}})),[u,function(t){var e;return o(this,void 0,void 0,(function*(){t.preventDefault();const o=[],[a,d]=yield u,f={};for(const[t,n]of new FormData(this).entries())if(t.includes(".")){const[o,r]=t.split(".",2);null!==(e=f[o])&&void 0!==e||(f[o]={}),f[o][r]=n}else f[t]="Phone"===t&&""!==n?"+"+/\D/g[Symbol.replace](n,""):n;if(a.newUser){f.pictureUrl=`https://www.e-comas.com/docs/signatures/ressources/${d.substring(0,d.indexOf("@"))}.jpg`,a.newUser=!1;const t=[...i(d,f)].join("\n");o.push({insertText:{text:t,endOfSegmentLocation:{segmentId:""}}}),n(0,u=Promise.resolve([st(t)[d],d]))}else if(JSON.stringify(a)!==JSON.stringify(f)){const t=(yield gapi.client.docs.documents.get({documentId:r})).result.body.content.flatMap((t=>{var e,n;return null!==(n=null===(e=t.paragraph)||void 0===e?void 0:e.elements.map((({startIndex:t,endIndex:e,textRun:n})=>({startIndex:t,endIndex:e,text:n.content}))))&&void 0!==n?n:[]})),e=/^\s*\["[^"]+@[^"]+"\]\s*$/,i=/\S/;let m,p=!1;for(const{startIndex:n,endIndex:r,text:c}of t)if(i.test(c)){if(e.test(c)){if(p)break;c.trim()===`[${at(d)}]`&&(p=!0)}else if(p&&(m=r,l(f,st(c)))){const t=c.slice(0,c.indexOf("=")).trim(),e=s(f,t);""===e?delete a[t]:a[t]=e,o.unshift({deleteContentRange:{range:{segmentId:"",startIndex:n,endIndex:r}}},""===e||null==e?void 0:{insertText:{location:{index:n,segmentId:""},text:`${t} = ${at(e)}\n`}})}}else;for(const{entry:[t,e]}of c(f,a))a[t]=e,o.unshift({insertText:{location:{index:m,segmentId:""},text:`${t} = ${at(e)}\n`}});n(0,u=Promise.resolve([a,d]))}o.length&&(yield gapi.client.docs.documents.batchUpdate({documentId:r,requests:o}))}))}]}class Yt extends J{constructor(t){super(),B(this,t,Gt,Jt,i,{})}}function Vt(e){let n,o,r,i,f=(e[8].message||e[8].error.message)+"";return{c(){n=a("p"),n.textContent="Unable to connect to Google API.",o=d(),r=a("p"),i=u(f),g(n,"color","red"),g(r,"color","red")},m(t,e){s(t,n,e),s(t,o,e),s(t,r,e),l(r,i)},p:t,d(t){t&&c(n),t&&c(o),t&&c(r)}}}function Kt(t){let e;function n(t,e){return t[1]?Xt:Qt}let o=n(t),r=o(t);return{c(){r.c(),e=f()},m(t,n){r.m(t,n),s(t,e,n)},p(t,i){o===(o=n(t))&&r?r.p(t,i):(r.d(1),r=o(t),r&&(r.c(),r.m(e.parentNode,e)))},d(t){r.d(t),t&&c(e)}}}function Qt(t){let e,n,o,r;function i(t,e){return t[0]?te:Zt}let u=i(t),d=u(t);return{c(){e=a("p"),n=a("button"),d.c()},m(i,c){s(i,e,c),l(e,n),d.m(n,null),o||(r=m(n,"click",t[7]),o=!0)},p(e,o){u!==(u=i(t=e))&&(d.d(1),d=u(t),d&&(d.c(),d.m(n,null)))},d(t){t&&c(e),d.d(),o=!1,r()}}}function Xt(t){let e,n,o={ctx:t,current:null,token:null,hasCatch:!0,pending:oe,then:ne,catch:ee,error:8};return N(n=t[1],o),{c(){e=f(),o.block.c()},m(t,n){s(t,e,n),o.block.m(t,o.anchor=n),o.mount=()=>e.parentNode,o.anchor=e},p(e,r){t=e,o.ctx=t,2&r&&n!==(n=t[1])&&N(n,o)||M(o,t,r)},d(t){t&&c(e),o.block.d(t),o.token=null,o=null}}}function Zt(t){let e;return{c(){e=u("Sign in")},m(t,n){s(t,e,n)},d(t){t&&c(e)}}}function te(t){let e;return{c(){e=u("Sign out")},m(t,n){s(t,e,n)},d(t){t&&c(e)}}}function ee(t){let e,n,r,i,f,p,b,y,w,x,v=(t[8].message||t[8].error||"Error")+"";return{c(){e=a("p"),n=u("An error occured: "),r=u(v),i=u("."),f=d(),p=a("button"),p.textContent="Try again",b=d(),y=a("button"),y.textContent="Cancel",g(e,"color","red")},m(o,c){s(o,e,c),l(e,n),l(e,r),l(e,i),s(o,f,c),s(o,p,c),s(o,b,c),s(o,y,c),w||(x=[m(p,"click",t[7]),m(y,"click",t[2])],w=!0)},p(e,n){t=e,2&n&&v!==(v=(t[8].message||t[8].error||"Error")+"")&&h(r,v)},d(t){t&&c(e),t&&c(f),t&&c(p),t&&c(b),t&&c(y),w=!1,o(x)}}}function ne(e){return{c:t,m:t,p:t,d:t}}function oe(e){let n;return{c(){n=a("p"),n.textContent="...loading"},m(t,e){s(t,n,e)},p:t,d(t){t&&c(n)}}}function re(e){let n;return{c(){n=a("p"),n.textContent="...loading"},m(t,e){s(t,n,e)},p:t,d(t){t&&c(n)}}}function ie(t){let e,n;return e=new Yt({}),{c(){q(e.$$.fragment)},m(t,o){R(e,t,o),n=!0},i(t){n||(O(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function le(t){let e,n,o,r,i,u={ctx:t,current:null,token:null,hasCatch:!0,pending:re,then:Kt,catch:Vt,value:7,error:8};N(t[3],u);let f=t[0]&&ie();return{c(){e=a("main"),n=a("h1"),n.textContent="Email signature tool",o=d(),u.block.c(),r=d(),f&&f.c(),p(n,"class","svelte-1wmija6"),p(e,"class","svelte-1wmija6")},m(t,c){s(t,e,c),l(e,n),l(e,o),u.block.m(e,u.anchor=null),u.mount=()=>e,u.anchor=r,l(e,r),f&&f.m(e,null),i=!0},p(n,[o]){M(u,t=n,o),t[0]?f?1&o&&O(f,1):(f=ie(),f.c(),O(f,1),f.m(e,null)):f&&(U(),S(f,1,1,(()=>{f=null})),H())},i(t){i||(O(f),i=!0)},o(t){S(f),i=!1},d(t){t&&c(e),u.block.d(),u.token=null,u=null,f&&f.d()}}}function se(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function l(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,s)}c((o=o.apply(t,e||[])).next())}))},r=this&&this.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e);function o(n){e[n]=t[n]&&function(e){return new Promise((function(o,r){(function(t,e,n,o){Promise.resolve(o).then((function(e){t({value:e,done:n})}),e)})(o,r,(e=t[n](e)).done,e.value)}))}}};let i,l;const s=import("./gdocs-44958914.js").then((t=>{const e=t.subscribeToConnectionStatus(),s=e.next();return function(t){var e,s,c,a;o(this,void 0,void 0,(function*(){try{for(e=r(t);!(s=yield e.next()).done;){const t=s.value;n(0,i=t),n(1,l=null)}}catch(t){c={error:t}}finally{try{s&&!s.done&&(a=e.return)&&(yield a.call(e))}finally{if(c)throw c.error}}}))}(e),Promise.all([t.initClientPromise,s]).then((([,e])=>(n(0,i=e.value),()=>{n(1,l=new Promise(((e,n)=>(i?t.disconnect():t.connect()).then(e,n))))})))}));return[i,l,function(){n(1,l=null)},s]}const ce=new class extends J{constructor(t){super(),B(this,t,se,le,i,{})}}({target:document.body,props:{}});export{ce as a,Mt as g};
//# sourceMappingURL=main-e3aa1ce0.js.map
