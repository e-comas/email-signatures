function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n||null)}function c(e){e.parentNode.removeChild(e)}function s(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function f(){return u(" ")}function d(){return u("")}function p(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function g(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function h(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}let b;function y(e){b=e}function $(){if(!b)throw new Error("Function called outside component initialization");return b}const w=[],v=[],x=[],_=[],k=Promise.resolve();let A=!1;function I(e){x.push(e)}let C=!1;const j=new Set;function P(){if(!C){C=!0;do{for(let e=0;e<w.length;e+=1){const t=w[e];y(t),E(t.$$)}for(y(null),w.length=0;v.length;)v.pop()();for(let e=0;e<x.length;e+=1){const t=x[e];j.has(t)||(j.add(t),t())}x.length=0}while(w.length);for(;_.length;)_.pop()();A=!1,C=!1,j.clear()}}function E(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(I)}}const T=new Set;let L,U;function O(){L={r:0,c:[],p:L}}function S(){L.r||r(L.c),L=L.p}function z(e,t){e&&e.i&&(T.delete(e),e.i(t))}function N(e,t,n,r){if(e&&e.o){if(T.has(e))return;T.add(e),L.c.push((()=>{T.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function q(e,t){const n=t.token={};function r(e,r,o,l){if(t.token!==n)return;t.resolved=l;let i=t.ctx;void 0!==o&&(i=i.slice(),i[o]=l);const a=e&&(t.current=e)(i);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==r&&e&&(O(),N(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),S())})):t.block.d(1),a.c(),z(a,1),a.m(t.mount(),t.anchor),c=!0),t.block=a,t.blocks&&(t.blocks[r]=a),c&&P()}if((o=e)&&"object"==typeof o&&"function"==typeof o.then){const n=$();if(e.then((e=>{y(n),r(t.then,1,t.value,e),y(null)}),(e=>{if(y(n),r(t.catch,2,t.error,e),y(null),!t.hasCatch)throw e})),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}var o}function R(e,t,n){const r=t.slice(),{resolved:o}=e;e.current===e.then&&(r[e.value]=o),e.current===e.catch&&(r[e.error]=o),e.block.p(r,n)}function H(e){e&&e.c()}function M(e,n,l,i){const{fragment:a,on_mount:c,on_destroy:s,after_update:u}=e.$$;a&&a.m(n,l),i||I((()=>{const n=c.map(t).filter(o);s?s.push(...n):r(n),e.$$.on_mount=[]})),u.forEach(I)}function D(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function W(e,t){-1===e.$$.dirty[0]&&(w.push(e),A||(A=!0,k.then(P)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function F(t,o,l,i,a,s,u=[-1]){const f=b;y(t);const d=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:o.context||[]),callbacks:n(),dirty:u,skip_bound:!1};let p=!1;if(d.ctx=l?l(t,o.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=o)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](o),p&&W(t,e)),n})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!i&&i(d.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);d.fragment&&d.fragment.l(e),e.forEach(c)}else d.fragment&&d.fragment.c();o.intro&&z(t.$$.fragment),M(t,o.target,o.anchor,o.customElement),P()}y(f)}class B{$destroy(){D(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}let Y=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Y.decode();let J=null;function V(){return null!==J&&J.buffer===U.memory.buffer||(J=new Uint8Array(U.memory.buffer)),J}function G(e,t){return Y.decode(V().subarray(e,e+t))}const Q=new Array(32).fill(void 0);Q.push(void 0,null,!0,!1);let K=Q.length;function X(e){K===Q.length&&Q.push(Q.length+1);const t=K;return K=Q[t],Q[t]=e,t}function Z(e){return Q[e]}let ee=0,te=new TextEncoder("utf-8");const ne="function"==typeof te.encodeInto?function(e,t){return te.encodeInto(e,t)}:function(e,t){const n=te.encode(e);return t.set(n),{read:e.length,written:n.length}};function re(e,t,n){if(ArrayBuffer.isView(e)){const n=e.byteLength,r=t(n);return V().set(e,r),ee=n,r}if(void 0===n){const n=te.encode(e),r=t(n.length);return V().subarray(r,r+n.length).set(n),ee=n.length,r}let r=e.length,o=t(r);const l=V();let i=0;for(;i<r;i++){const t=e.charCodeAt(i);if(t>127)break;l[o+i]=t}if(i!==r){0!==i&&(e=e.slice(i)),o=n(o,r,r=i+3*e.length);const t=V().subarray(o+i,o+r);i+=ne(e,t).written}return ee=i,o}let oe=null;function le(){return null!==oe&&oe.buffer===U.memory.buffer||(oe=new Int32Array(U.memory.buffer)),oe}function ie(e){const t=Z(e);return function(e){e<36||(Q[e]=K,K=e)}(e),t}function ae(e){var t=re(e,U.__wbindgen_malloc,U.__wbindgen_realloc),n=ee;return ie(U.parse(t,n))}let ce=32;function se(e){try{const r=U.__wbindgen_export_2.value-16;U.__wbindgen_export_2.value=r,U.stringify(r,function(e){if(1==ce)throw new Error("out of js stack");return Q[--ce]=e,ce}(e));var t=le()[r/4+0],n=le()[r/4+1];return G(t,n)}finally{U.__wbindgen_export_2.value+=16,Q[ce++]=void 0,U.__wbindgen_free(t,n)}}async function ue(e){void 0===e&&(e=import.meta.url.replace(/\.js$/,"_bg.wasm"));const t={wbg:{}};t.wbg.__wbindgen_json_parse=function(e,t){return X(JSON.parse(G(e,t)))},t.wbg.__wbindgen_json_serialize=function(e,t){const n=Z(t);var r=re(JSON.stringify(void 0===n?null:n),U.__wbindgen_malloc,U.__wbindgen_realloc),o=ee;le()[e/4+1]=o,le()[e/4+0]=r},t.wbg.__wbindgen_string_new=function(e,t){return X(G(e,t))},t.wbg.__wbindgen_rethrow=function(e){throw ie(e)},("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return U=n.exports,ue.__wbindgen_wasm_module=r,U}function fe(e){let t,n,r,o;return{c(){t=s("label"),n=u(e[2]),r=f(),o=s("input"),m(o,"name",e[0]),o.value=e[6],m(o,"type",e[4]),m(o,"autocomplete",e[1]),m(o,"placeholder",e[3]),o.required=e[5]},m(l,c){a(l,t,c),i(t,n),i(t,r),i(t,o),e[9](o)},p(e,t){4&t&&g(n,e[2]),1&t&&m(o,"name",e[0]),64&t&&o.value!==e[6]&&(o.value=e[6]),16&t&&m(o,"type",e[4]),2&t&&m(o,"autocomplete",e[1]),8&t&&m(o,"placeholder",e[3]),32&t&&(o.required=e[5])},d(n){n&&c(t),e[9](null)}}}function de(e){let t;return{c(){t=s("input"),m(t,"type",e[4]),m(t,"name",e[0]),t.value=e[6]},m(e,n){a(e,t,n)},p(e,n){16&n&&m(t,"type",e[4]),1&n&&m(t,"name",e[0]),64&n&&t.value!==e[6]&&(t.value=e[6])},d(e){e&&c(t)}}}function pe(t){let n;function r(e,t){return"hidden"===e[4]?de:fe}let o=r(t),l=o(t);return{c(){l.c(),n=d()},m(e,t){l.m(e,t),a(e,n,t)},p(e,[t]){o===(o=r(e))&&l?l.p(e,t):(l.d(1),l=o(e),l&&(l.c(),l.m(n.parentNode,n)))},i:e,o:e,d(e){l.d(e),e&&c(n)}}}function me(e,t,n){let r,{name:o}=t,{autocomplete:l="auto"}=t,{autofocus:i=!1}=t,{label:a=o}=t,{placeholder:c}=t,{type:s="text"}=t,{required:u=!1}=t,{value:f=""}=t;var d;return i&&(d=()=>r.focus(),$().$$.on_mount.push(d)),e.$$set=e=>{"name"in e&&n(0,o=e.name),"autocomplete"in e&&n(1,l=e.autocomplete),"autofocus"in e&&n(8,i=e.autofocus),"label"in e&&n(2,a=e.label),"placeholder"in e&&n(3,c=e.placeholder),"type"in e&&n(4,s=e.type),"required"in e&&n(5,u=e.required),"value"in e&&n(6,f=e.value)},[o,l,a,c,s,u,f,r,i,function(e){v[e?"unshift":"push"]((()=>{r=e,n(7,r)}))}]}class ge extends B{constructor(e){super(),F(this,e,me,pe,l,{name:0,autocomplete:1,autofocus:8,label:2,placeholder:3,type:4,required:5,value:6})}}function he(e){let t,n,r,l,u,d,g,h,b,y,$,w,v,x,_,k,A,I,C,j,P,E,T,L,U,O;return u=new ge({props:{name:"Name",value:e[1],required:!0,autocomplete:"name"}}),g=new ge({props:{name:"Title",value:e[2],autocomplete:"organization-title",autofocus:!0,required:!0}}),b=new ge({props:{name:"Phone",value:e[3],type:"phone",placeholder:"International phone number (optional)"}}),$=new ge({props:{name:"pictureUrl",value:e[4],type:"hidden"}}),v=new ge({props:{name:"url.Facebook",value:e[5],type:"url",placeholder:"Public URL to your Facebook profile (optional)"}}),_=new ge({props:{name:"url.LinkedIn",value:e[7],type:"url",placeholder:"Public URL to your LinkedIn profile (optional)"}}),A=new ge({props:{name:"url.Medium",value:e[6],type:"url",placeholder:"Public URL to your Medium profile (optional)"}}),C=new ge({props:{name:"url.Twitter",value:e[8],type:"url",placeholder:"Public URL to your Twitter profile (optional)"}}),P=new ge({props:{name:"url.YouTube",value:e[9],type:"url",placeholder:"Public URL to your YouTube channel (optional)"}}),{c(){t=s("form"),n=s("fieldset"),r=s("legend"),r.textContent="Personal information",l=f(),H(u.$$.fragment),d=f(),H(g.$$.fragment),h=f(),H(b.$$.fragment),y=f(),H($.$$.fragment),w=f(),H(v.$$.fragment),x=f(),H(_.$$.fragment),k=f(),H(A.$$.fragment),I=f(),H(C.$$.fragment),j=f(),H(P.$$.fragment),E=f(),T=s("button"),T.textContent="Save my information",m(T,"type","submit")},m(c,s){a(c,t,s),i(t,n),i(n,r),i(n,l),M(u,n,null),i(n,d),M(g,n,null),i(n,h),M(b,n,null),i(n,y),M($,n,null),i(n,w),M(v,n,null),i(n,x),M(_,n,null),i(n,k),M(A,n,null),i(n,I),M(C,n,null),i(n,j),M(P,n,null),i(n,E),i(n,T),L=!0,U||(O=p(t,"submit",(function(){o(e[0])&&e[0].apply(this,arguments)})),U=!0)},p(t,[n]){e=t},i(e){L||(z(u.$$.fragment,e),z(g.$$.fragment,e),z(b.$$.fragment,e),z($.$$.fragment,e),z(v.$$.fragment,e),z(_.$$.fragment,e),z(A.$$.fragment,e),z(C.$$.fragment,e),z(P.$$.fragment,e),L=!0)},o(e){N(u.$$.fragment,e),N(g.$$.fragment,e),N(b.$$.fragment,e),N($.$$.fragment,e),N(v.$$.fragment,e),N(_.$$.fragment,e),N(A.$$.fragment,e),N(C.$$.fragment,e),N(P.$$.fragment,e),L=!1},d(e){e&&c(t),D(u),D(g),D(b),D($),D(v),D(_),D(A),D(C),D(P),U=!1,O()}}}function be(e,t,n){let{user:r}=t,{onsubmit:o}=t;const{Name:l,Title:i,Phone:a,pictureUrl:c}=r,{Facebook:s,Medium:u,LinkedIn:f,Twitter:d,YouTube:p}=r.url||{};return e.$$set=e=>{"user"in e&&n(10,r=e.user),"onsubmit"in e&&n(0,o=e.onsubmit)},[o,l,i,a,c,s,u,f,d,p,r]}class ye extends B{constructor(e){super(),F(this,e,be,he,l,{user:10,onsubmit:0})}}var $e=[376,971,93,355,374,244,54,43,61,297,994,387,880,32,226,359,973,257,229,673,591,55,975,267,375,501,243,236,242,41,225,682,56,237,86,57,506,53,238,599,357,420,49,253,45,213,593,372,20,291,34,251,358,679,691,298,33,241,44,995,594,233,350,299,220,224,590,240,30,502,245,592,852,504,385,509,36,62,353,972,91,246,964,98,354,39,962,81,254,996,855,269,850,82,965,856,961,423,94,231,266,370,352,371,218,212,377,373,382,261,692,389,223,95,976,853,596,222,356,230,960,265,52,60,258,264,687,227,672,234,505,31,47,977,674,683,64,968,507,51,689,675,63,92,48,508,970,351,680,595,974,262,40,381,7,250,966,677,248,249,46,65,386,421,232,378,221,252,597,211,239,503,963,268,235,228,66,992,670,993,216,676,90,688,886,255,380,256,1,598,998,58,84,678,681,685,383,967,27,260,263,800,808,870,878,881,882,883,888,979];const we=new URL("./data/",import.meta.url);var ve=e=>fetch(new URL(`./${e}.json`,we)).then((e=>e.ok?e.json():Promise.reject(new Error(e.statusText))));async function xe(e){const[t,n,r]=await async function(e){const t="+"===e[0]?1:0;for(let n=t;n<e.length;n++){const r=Number(e.slice(t,n));if($e.includes(r))return[r,e.slice(n),await ve(r)]}return Promise.reject(new Error("Unable to find valid country code"))}(e);let o;for(const{leadingDigits:e,pattern:t,format:l}of r)if(new RegExp(`^(${e})`).test(n)){const e=new RegExp(`${t}$`);if(e.test(n)){o=n.replace(e,l);break}}return`+${t} ${o||n}`}function _e(e,t,n){const r=e.slice();return r[3]=t[n][0],r[4]=t[n][1],r}function ke(t){let n,r,o;return{c(){n=s("a"),r=s("img"),m(r,"width","26"),m(r,"alt",t[3]+" icon"),h(r,"border","0"),h(r,"height","26px"),h(r,"width","26px"),r.src!==(o=`https://e-comas.com/icons/${t[3].toLowerCase()}.jpg`)&&m(r,"src",o),m(n,"href",t[4]),m(n,"target","_blank"),m(n,"rel","noopener")},m(e,t){a(e,n,t),i(n,r)},p:e,d(e){e&&c(n)}}}function Ae(t){let n,r=t[1],o=[];for(let e=0;e<r.length;e+=1)o[e]=ke(_e(t,r,e));return{c(){n=s("div");for(let e=0;e<o.length;e+=1)o[e].c();m(n,"style",t[0])},m(e,t){a(e,n,t);for(let e=0;e<o.length;e+=1)o[e].m(n,null)},p(e,[t]){if(2&t){let l;for(r=e[1],l=0;l<r.length;l+=1){const i=_e(e,r,l);o[l]?o[l].p(i,t):(o[l]=ke(i),o[l].c(),o[l].m(n,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=r.length}1&t&&m(n,"style",e[0])},i:e,o:e,d(e){e&&c(n),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(o,e)}}}function Ie(e,t,n){let{links:r}=t,{style:o}=t;r.link="https://www.e-comas.com/";const l=Object.entries(r);return e.$$set=e=>{"links"in e&&n(2,r=e.links),"style"in e&&n(0,o=e.style)},[o,l,r]}class Ce extends B{constructor(e){super(),F(this,e,Ie,Ae,l,{links:2,style:0})}}function je(e){e[10]=e[12][0],e[11]=e[12][1]}function Pe(t){let n,r,o=t[13]+"";return{c(){n=s("p"),r=u(o),h(n,"color","red")},m(e,t){a(e,n,t),i(n,r)},p:e,i:e,o:e,d(e){e&&c(n)}}}function Ee(t){let n,r,o,l,d,p,b,y,$,w,v,x,_,k,A,I,C,j,P,E,T,L,U,O,S,q,R,W,F,B,Y,J,V,G,Q,K,X,Z,ee,te;je(t);let ne=t[3]&&function(t){let n,r,o,l,f=t[10]+"";return{c(){n=s("tr"),r=s("td"),o=s("a"),l=u(f),m(o,"href","tel:"+t[3]),m(o,"target","_blank"),h(o,"color","#0c195a"),h(o,"text-decoration","none"),h(r,"font-family","Arial, Helvetica, sans-serif"),h(r,"font-size","14px"),h(r,"vertical-align","top")},m(e,t){a(e,n,t),i(n,r),i(r,o),i(o,l)},p:e,d(e){e&&c(n)}}}(t);return Q=new Ce({props:{links:t[5],style:"display: flex; gap: 5px;"}}),{c(){n=s("table"),r=s("tbody"),o=s("tr"),l=s("td"),d=s("table"),p=s("tbody"),b=s("tr"),y=s("td"),$=s("img"),v=f(),x=s("td"),_=s("table"),k=s("tbody"),A=s("tr"),I=s("td"),C=s("strong"),C.textContent=`${t[1]}`,j=f(),P=s("tr"),E=s("td"),T=s("strong"),T.textContent=`${t[2]}`,L=f(),U=s("tr"),O=s("td"),S=s("a"),q=u(t[0]),W=f(),ne&&ne.c(),F=f(),B=s("tr"),Y=s("td"),Y.textContent=`${Ue}`,J=f(),V=s("tr"),G=s("td"),H(Q.$$.fragment),K=f(),X=s("tr"),X.innerHTML='<td style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; vertical-align: top;"><table cellpadding="0" cellspacing="0" style="mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: separate;"><tbody><tr><td style="font-family: Arial, Helvetica, sans-serif; font-size: 14px; vertical-align: top;"><a href="https://www.e-comas.com/white-paper-form.html" target="_blank" rel="noopener" style="color: #0c195a; text-decoration: none;"><img alt="Logo" width="540" height="90" src="https://www.e-comas.com/docs/signatures/ressources/how-to-manage-amazon.jpg" style="-ms-interpolation-mode: bicubic; max-width: 100%; height: auto; border: none; padding-right: 5px;"/></a></td></tr></tbody></table></td>',Z=f(),ee=s("style"),ee.textContent="#signature { text-align: initial; }",m($,"alt",t[1]+"'s picture"),m($,"width",t[11]),m($,"height",Oe),$.src!==(w=t[4])&&m($,"src",w),h($,"-ms-interpolation-mode","bicubic"),h($,"max-width","100%"),h($,"height","auto"),h($,"border","none"),h($,"padding-right","5px"),h(y,"font-family","Arial, Helvetica, sans-serif"),h(y,"font-size","14px"),h(y,"vertical-align","top"),m(C,"class","name"),h(C,"color","#0c195a"),h(I,"font-family","Arial, Helvetica, sans-serif"),h(I,"font-size","14px"),h(I,"vertical-align","top"),h(T,"color","#0c195a"),h(E,"font-family","Arial, Helvetica, sans-serif"),h(E,"font-size","14px"),h(E,"vertical-align","top"),m(S,"href",R="mailto:"+t[0]),m(S,"target","_blank"),h(S,"color","#0c195a"),h(S,"text-decoration","none"),h(O,"font-family","Arial, Helvetica, sans-serif"),h(O,"font-size","14px"),h(O,"vertical-align","top"),h(Y,"font-family","Arial, Helvetica, sans-serif"),h(Y,"font-size","14px"),h(Y,"vertical-align","top"),m(_,"cellpadding","0"),m(_,"cellspacing","5"),h(_,"mso-table-lspace","0pt"),h(_,"mso-table-rspace","0pt"),h(_,"border-collapse","separate"),h(x,"font-family","Arial, Helvetica, sans-serif"),h(x,"font-size","14px"),h(x,"vertical-align","top"),m(d,"cellpadding","0"),m(d,"cellspacing","0"),h(d,"mso-table-lspace","0pt"),h(d,"mso-table-rspace","0pt"),h(d,"border-collapse","separate"),h(l,"font-family","Arial, Helvetica, sans-serif"),h(l,"font-size","14px"),h(l,"vertical-align","top"),h(G,"font-family","Arial, Helvetica, sans-serif"),h(G,"font-size","14px"),h(G,"vertical-align","top"),m(n,"id","signature"),m(n,"cellpadding","0"),m(n,"cellspacing","0"),h(n,"mso-table-lspace","0pt"),h(n,"mso-table-rspace","0pt"),h(n,"width","640px"),h(n,"padding","0"),h(n,"font-family","Arial, Helvetica, sans-serif"),h(n,"-webkit-font-smoothing","antialiased"),h(n,"font-size","14px"),h(n,"-ms-text-size-adjust","100%"),h(n,"-webkit-text-size-adjust","100%"),h(n,"border-collapse","separate")},m(e,t){a(e,n,t),i(n,r),i(r,o),i(o,l),i(l,d),i(d,p),i(p,b),i(b,y),i(y,$),i(b,v),i(b,x),i(x,_),i(_,k),i(k,A),i(A,I),i(I,C),i(k,j),i(k,P),i(P,E),i(E,T),i(k,L),i(k,U),i(U,O),i(O,S),i(S,q),i(k,W),ne&&ne.m(k,null),i(k,F),i(k,B),i(B,Y),i(r,J),i(r,V),i(V,G),M(Q,G,null),i(r,K),i(r,X),a(e,Z,t),a(e,ee,t),te=!0},p(e,t){je(e),(!te||1&t)&&g(q,e[0]),(!te||1&t&&R!==(R="mailto:"+e[0]))&&m(S,"href",R),e[3]&&ne.p(e,t)},i(e){te||(z(Q.$$.fragment,e),te=!0)},o(e){N(Q.$$.fragment,e),te=!1},d(e){e&&c(n),ne&&ne.d(),D(Q),e&&c(Z),e&&c(ee)}}}function Te(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&c(n)}}}function Le(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Te,then:Ee,catch:Pe,value:12,error:13,blocks:[,,,]};return q(e[6],r),{c(){t=d(),r.block.c()},m(e,o){a(e,t,o),r.block.m(e,r.anchor=o),r.mount=()=>t.parentNode,r.anchor=t,n=!0},p(t,[n]){R(r,e=t,n)},i(e){n||(z(r.block),n=!0)},o(e){for(let e=0;e<3;e+=1){N(r.blocks[e])}n=!1},d(e){e&&c(t),r.block.d(e),r.token=null,r=null}}}const Ue="e-Comas Sarl, 68 Avenue de la Liberté, 1930 Luxembourg",Oe=105;function Se(e,t,n){var r;let{user:o}=t,{emailAddress:l}=t;const{Name:i,Title:a,Phone:c,pictureUrl:s}=o,u=null!==(r=o.url)&&void 0!==r?r:{},f=Promise.all([c?xe(c):Promise.resolve(),(e=>{const t=new Image;return t.src=e,t.decode().then((()=>t))})(s).then((e=>e.naturalWidth*(Oe/e.naturalHeight)),(e=>(console.error(e),Oe)))]);return e.$$set=e=>{"user"in e&&n(7,o=e.user),"emailAddress"in e&&n(0,l=e.emailAddress)},[l,i,a,c,s,u,f,o]}class ze extends B{constructor(e){super(),F(this,e,Se,Le,l,{user:7,emailAddress:0})}}function Ne(t){let n,o,l,i,u;return{c(){n=s("button"),n.textContent="Copy signature",o=f(),l=s("button"),l.textContent="Copy HTML code"},m(e,r){a(e,n,r),a(e,o,r),a(e,l,r),i||(u=[p(n,"click",t[0]),p(l,"click",t[1])],i=!0)},p:e,i:e,o:e,d(e){e&&c(n),e&&c(o),e&&c(l),i=!1,r(u)}}}function qe(e){const t=()=>document.getElementById("signature").outerHTML;return[function(e){e.preventDefault(),navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([t()],{type:"text/html"})})])},function(e){e.preventDefault(),navigator.clipboard.writeText(t())}]}class Re extends B{constructor(e){super(),F(this,e,qe,Ne,l,{})}}var He={CLIENT_ID:"574901819149-d46caor3hasi3bsngfua2q20idump433.apps.googleusercontent.com",API_KEY:"AIzaSyDIzIuLKqaQhWXSykVOWOQLqlLggFTDOh8",documentId:"1fGE2MU0CrxxRaC-YrvPzk-3aqOsqfcIVQPOeFmkmMTI"};function Me(e){e[10]=e[12][0],e[11]=e[12][1]}function De(t){let n,r,o=(t[13]?t[13].message||(t[13].result?`${t[13].result.error.code} ${t[13].result.error.status}: ${t[13].result.error.message}`:t[13]):"Unknown error")+"";return{c(){n=s("p"),r=u(o),h(n,"color","red")},m(e,t){a(e,n,t),i(n,r)},p(e,t){1&t&&o!==(o=(e[13]?e[13].message||(e[13].result?`${e[13].result.error.code} ${e[13].result.error.status}: ${e[13].result.error.message}`:e[13]):"Unknown error")+"")&&g(r,o)},i:e,o:e,d(e){e&&c(n)}}}function We(e){let t,n,r,o;Me(e),t=new ye({props:{user:e[10],onsubmit:e[1]}});let l=!e[10].newUser&&Fe(e);return{c(){H(t.$$.fragment),n=f(),l&&l.c(),r=d()},m(e,i){M(t,e,i),a(e,n,i),l&&l.m(e,i),a(e,r,i),o=!0},p(e,n){Me(e);const o={};1&n&&(o.user=e[10]),t.$set(o),e[10].newUser?l&&(O(),N(l,1,1,(()=>{l=null})),S()):l?(l.p(e,n),1&n&&z(l,1)):(l=Fe(e),l.c(),z(l,1),l.m(r.parentNode,r))},i(e){o||(z(t.$$.fragment,e),z(l),o=!0)},o(e){N(t.$$.fragment,e),N(l),o=!1},d(e){D(t,e),e&&c(n),l&&l.d(e),e&&c(r)}}}function Fe(e){let t,n,r,o,l,i,u,d;return r=new ze({props:{user:e[10],emailAddress:e[11]}}),u=new Re({}),{c(){t=s("hr"),n=f(),H(r.$$.fragment),o=f(),l=s("hr"),i=f(),H(u.$$.fragment)},m(e,c){a(e,t,c),a(e,n,c),M(r,e,c),a(e,o,c),a(e,l,c),a(e,i,c),M(u,e,c),d=!0},p(e,t){const n={};1&t&&(n.user=e[10]),1&t&&(n.emailAddress=e[11]),r.$set(n)},i(e){d||(z(r.$$.fragment,e),z(u.$$.fragment,e),d=!0)},o(e){N(r.$$.fragment,e),N(u.$$.fragment,e),d=!1},d(e){e&&c(t),e&&c(n),D(r,e),e&&c(o),e&&c(l),e&&c(i),D(u,e)}}}function Be(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&c(n)}}}function Ye(e){let t,n,r,o={ctx:e,current:null,token:null,hasCatch:!0,pending:Be,then:We,catch:De,value:12,error:13,blocks:[,,,]};return q(n=e[0],o),{c(){t=d(),o.block.c()},m(e,n){a(e,t,n),o.block.m(e,o.anchor=n),o.mount=()=>t.parentNode,o.anchor=t,r=!0},p(t,[r]){e=t,o.ctx=e,1&r&&n!==(n=e[0])&&q(n,o)||R(o,e,r)},i(e){r||(z(o.block),r=!0)},o(e){for(let e=0;e<3;e+=1){N(o.blocks[e])}r=!1},d(e){e&&c(t),o.block.d(e),o.token=null,o=null}}}function Je(e){if(e&&"object"==typeof e)return e.content?e.content:Object.values(e).map(Je).join("")}function Ve(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function i(e){try{c(r.next(e))}catch(e){l(e)}}function a(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};const{documentId:o}=He;function*l(e,t){yield"",yield"";const n=[];yield se({[e]:Object.fromEntries(Object.entries(t).filter((([e,t])=>!!t&&(!("object"==typeof t&&!Array.isArray(t))||(n.push(function*(e,t){for(const[n,r]of Object.entries(t))r&&(yield`${e}.${se({[n]:r})}`)}(e,t)),!1)))))}).trimEnd();for(const e of n)yield*e}const i=(e,t)=>Object.entries(t).some((([t,n])=>"object"==typeof n?i(e[t],n):e[t]!==n)),a=(e,t)=>{if(t.includes(".")){const[n,r]=t.split(".",2);return e[n][r]}return e[t]},c=(e,t,n="")=>Object.entries(e).flatMap((([e,r])=>r&&r!==t[e]?"string"==typeof r||Array.isArray(r)?{entry:[`${n}${e}`,r]}:c(r,t[e],`${e}.`):[]));function s(e){return ae(e.result.body.content.map(Je).join("\n"))}let u=Promise.all([ue("build/5bb3b01f8af02723.wasm"),gapi.client.docs.documents.get({documentId:o}),location.hash.includes("@")?Promise.resolve({result:{email:location.hash.slice(1)}}):gapi.client.request({method:"GET",path:"/userinfo/v2/me"})]).then((([e,t,n])=>{var r;return[null!==(r=s(t)[n.result.email])&&void 0!==r?r:{Name:n.result.name,newUser:!0},n.result.email]}));return u.catch(console.error),window.addEventListener("hashchange",(()=>{if(location.hash.includes("@")){const e=location.hash.slice(1);n(0,u=gapi.client.docs.documents.get({documentId:o}).then((t=>{var n;return[null!==(n=s(t)[e])&&void 0!==n?n:{newUser:!0},e]})))}})),[u,function(e){var t;return r(this,void 0,void 0,(function*(){e.preventDefault();const r=[],[s,f]=yield u,d={};for(const[e,n]of new FormData(this).entries())if(e.includes(".")){const[r,o]=e.split(".",2);null!==(t=d[r])&&void 0!==t||(d[r]={}),d[r][o]=n}else d[e]="Phone"===e&&""!==n?"+"+/\D/g[Symbol.replace](n,""):n;if(s.newUser){d.pictureUrl=`https://www.e-comas.com/docs/signatures/ressources/${f.substring(0,f.indexOf("@"))}.jpg`,s.newUser=!1;const e=[...l(f,d)].join("\n");r.push({insertText:{text:e,endOfSegmentLocation:{segmentId:""}}}),n(0,u=Promise.resolve([ae(e)[f],f]))}else if(JSON.stringify(s)!==JSON.stringify(d)){const e=(yield gapi.client.docs.documents.get({documentId:o})).result.body.content.flatMap((e=>{var t,n;return null!==(n=null===(t=e.paragraph)||void 0===t?void 0:t.elements.map((({startIndex:e,endIndex:t,textRun:n})=>({startIndex:e,endIndex:t,text:n.content}))))&&void 0!==n?n:[]})),t=/^\s*\["[^"]+@[^"]+"\]\s*$/,l=/\S/;let p,m=!1;for(const{startIndex:n,endIndex:o,text:c}of e)if(l.test(c)){if(t.test(c)){if(m)break;c.trim()===`[${se(f)}]`&&(m=!0)}else if(m&&(p=o,i(d,ae(c)))){const e=c.slice(0,c.indexOf("=")).trim(),t=a(d,e);""===t?delete s[e]:s[e]=t,r.unshift({deleteContentRange:{range:{segmentId:"",startIndex:n,endIndex:o}}},""===t?void 0:{insertText:{location:{index:n,segmentId:""},text:`${e} = ${se(t)}\n`}})}}else;for(const{entry:[e,t]}of c(d,s))s[e]=t,r.unshift({insertText:{location:{index:p,segmentId:""},text:`${e} = ${se(t)}\n`}});n(0,u=Promise.resolve([s,f]))}r.length&&(yield gapi.client.docs.documents.batchUpdate({documentId:o,requests:r}))}))}]}class Ge extends B{constructor(e){super(),F(this,e,Ve,Ye,l,{})}}function Qe(t){let n,r,o,l,d=(t[8].message||t[8].error.message)+"";return{c(){n=s("p"),n.textContent="Unable to connect to Google API.",r=f(),o=s("p"),l=u(d),h(n,"color","red"),h(o,"color","red")},m(e,t){a(e,n,t),a(e,r,t),a(e,o,t),i(o,l)},p:e,d(e){e&&c(n),e&&c(r),e&&c(o)}}}function Ke(e){let t;function n(e,t){return e[1]?Ze:Xe}let r=n(e),o=r(e);return{c(){o.c(),t=d()},m(e,n){o.m(e,n),a(e,t,n)},p(e,l){r===(r=n(e))&&o?o.p(e,l):(o.d(1),o=r(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o.d(e),e&&c(t)}}}function Xe(e){let t,n,r,o;function l(e,t){return e[0]?tt:et}let u=l(e),f=u(e);return{c(){t=s("p"),n=s("button"),f.c()},m(l,c){a(l,t,c),i(t,n),f.m(n,null),r||(o=p(n,"click",e[7]),r=!0)},p(t,r){u!==(u=l(e=t))&&(f.d(1),f=u(e),f&&(f.c(),f.m(n,null)))},d(e){e&&c(t),f.d(),r=!1,o()}}}function Ze(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:ot,then:rt,catch:nt,error:8};return q(n=e[1],r),{c(){t=d(),r.block.c()},m(e,n){a(e,t,n),r.block.m(e,r.anchor=n),r.mount=()=>t.parentNode,r.anchor=t},p(t,o){e=t,r.ctx=e,2&o&&n!==(n=e[1])&&q(n,r)||R(r,e,o)},d(e){e&&c(t),r.block.d(e),r.token=null,r=null}}}function et(e){let t;return{c(){t=u("Sign in")},m(e,n){a(e,t,n)},d(e){e&&c(t)}}}function tt(e){let t;return{c(){t=u("Sign out")},m(e,n){a(e,t,n)},d(e){e&&c(t)}}}function nt(e){let t,n,o,l,d,m,b,y,$,w,v=(e[8].message||e[8].error||"Error")+"";return{c(){t=s("p"),n=u("An error occured: "),o=u(v),l=u("."),d=f(),m=s("button"),m.textContent="Try again",b=f(),y=s("button"),y.textContent="Cancel",h(t,"color","red")},m(r,c){a(r,t,c),i(t,n),i(t,o),i(t,l),a(r,d,c),a(r,m,c),a(r,b,c),a(r,y,c),$||(w=[p(m,"click",e[7]),p(y,"click",e[2])],$=!0)},p(t,n){e=t,2&n&&v!==(v=(e[8].message||e[8].error||"Error")+"")&&g(o,v)},d(e){e&&c(t),e&&c(d),e&&c(m),e&&c(b),e&&c(y),$=!1,r(w)}}}function rt(t){return{c:e,m:e,p:e,d:e}}function ot(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){a(e,n,t)},p:e,d(e){e&&c(n)}}}function lt(t){let n;return{c(){n=s("p"),n.textContent="...loading"},m(e,t){a(e,n,t)},p:e,d(e){e&&c(n)}}}function it(e){let t,n;return t=new Ge({}),{c(){H(t.$$.fragment)},m(e,r){M(t,e,r),n=!0},i(e){n||(z(t.$$.fragment,e),n=!0)},o(e){N(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function at(e){let t,n,r,o,l,u={ctx:e,current:null,token:null,hasCatch:!0,pending:lt,then:Ke,catch:Qe,value:7,error:8};q(e[3],u);let d=e[0]&&it();return{c(){t=s("main"),n=s("h1"),n.textContent="Email signature tool",r=f(),u.block.c(),o=f(),d&&d.c(),m(n,"class","svelte-1wmija6"),m(t,"class","svelte-1wmija6")},m(e,c){a(e,t,c),i(t,n),i(t,r),u.block.m(t,u.anchor=null),u.mount=()=>t,u.anchor=o,i(t,o),d&&d.m(t,null),l=!0},p(n,[r]){R(u,e=n,r),e[0]?d?1&r&&z(d,1):(d=it(),d.c(),z(d,1),d.m(t,null)):d&&(O(),N(d,1,1,(()=>{d=null})),S())},i(e){l||(z(d),l=!0)},o(e){N(d),l=!1},d(e){e&&c(t),u.block.d(),u.token=null,u=null,d&&d.d()}}}function ct(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function i(e){try{c(r.next(e))}catch(e){l(e)}}function a(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}};let l,i;const a=import("./gdocs-385a3156.js").then((e=>{const t=e.subscribeToConnectionStatus(),a=t.next();return function(e){var t,a,c,s;r(this,void 0,void 0,(function*(){try{for(t=o(e);!(a=yield t.next()).done;){const e=a.value;n(0,l=e),n(1,i=null)}}catch(e){c={error:e}}finally{try{a&&!a.done&&(s=t.return)&&(yield s.call(t))}finally{if(c)throw c.error}}}))}(t),Promise.all([e.initClientPromise,a]).then((([,t])=>(n(0,l=t.value),()=>{n(1,i=new Promise(((t,n)=>(l?e.disconnect():e.connect()).then(t,n))))})))}));return[l,i,function(){n(1,i=null)},a]}const st=new class extends B{constructor(e){super(),F(this,e,ct,at,l,{})}}({target:document.body,props:{}});export{st as a,He as g};
//# sourceMappingURL=main-b4d4eed8.js.map
